\chapter{O Método dos Elementos Finitos}

\begin{quote}
    "As far as the laws of mathematics refer to reality, they are not certain; and as far as they are certain, they do not refer to reality." (Albert Einstein)
\end{quote}

O método dos elementos finitos (MEF) é um procedimento numérico utilizada para encontrar soluções de equações que modelam a natureza. É amplamente utilizado na simulação de fenômenos físicos, como mecânica dos sólidos, transferência de calor, eletromagnetismo e muitos outros. \cite{Onate}

A abordagem do MEF envolve a subdivisão de uma estrutura ou domínio contínuo em pequenos elementos geométricos finitos, definidos por nós, caracterizados por suas propriedades físicas e geométricas, em que são aplicadas as equações governantes do problema, cujo campo é aproximado, dentro de cada um, por meio de funções de interpolação, que vão discretizar o campo sobre os valores nodais. Em seguida, essas equações aproximadas são montadas, justapondo os elementos, em um sistema global, levando em consideração as condições de contorno e as restrições do problema. \cite{LIU}

Em suma, o método de elementos finitos segue o seguinte procedimento, de acordo com \citeshort{Onate}:

\begin{enumerate}
    \item definição do domínio, e das condições de contorno;
    \item discretização do domínio em uma malha formada por nós que constituem os elemento;
    \item aplicação das equações de governo sobre cada elemento, formando um sistema local de rigidez;
    \item montagem dessas equações em um único grande sistema global;
    \item resolução do sistema, encontrando os valores nodais do campo.
\end{enumerate}

Na análise estrutural aqui abordada, o objetivo da aplicação do MEF é determinar o deslocamento de um sólido em equilíbrio sujeito a carregamentos e restrições, dentro do regime elástico modelado pela Lei de Hooke, utilizando funções de interpolações lineares em elementos triangulares (na análise 2D: EPT ou EPD) e tetraédricos (na análise 3D). Para tanto, resolver um sistema da forma

\begin{equation}
    \bm{K} \bm{U} = \bm{F},
    \label{eq:sistema_global}
\end{equation}
em que $\bm{K}$ é a matriz de rigidez global, $\bm{U}$ é o vetor de deslocamentos nodais, e $\bm{F}$ é o vetor de forças nodais.

Deste modo, convém definir os termos e símbolos dessas entidades matemáticas. Seja um corpo $\mathcal{B}$, definido por uma geometria sobre o domínio $\Omega$, que é repartido em pequenos elementos, de domínio $\Omega^{(e)}$, cuja fronteira se denomina $\partial\Omega^{(e)}$. A figura \ref{fig:dominio_triangulo} mostra um domínio bidimensional $\Omega$ discretizado em elementos triangulares, cujos nós são representados por $i, j$ e $k$. Quando uma entidade é definida sobre um elemento, ela é representada por um superescrito $(e)$, como por exemplo o deslocamento $\bm{\varphi}^{(e)}$ sobre o elemento $e$.

Seguindo \citeshort{LOGAN}, neste capítulo aborda-se como
\begin{enumerate}
    \item selecionar as funções de interpolação;
    \item definir as relações de tensão-deformação-deslocamento;
    \item derivar a forma da matriz de rigidez;
    \item montar o sistema global e introduzir as condições de contorno.
\end{enumerate}

\input{Figuras/dominio_triangulos.tex}

\section{As Funções de Interpolação}

As funções de interpolação são funções matemáticas que aproximam o campo de interesse, neste caso o deslocamento, dentro de um elemento, por meio de uma combinação linear de funções conhecidas, definidas sobre os nós do elemento. Essas funções são definidas, e depois justapostas, de modo que o campo seja contínuo. O objetivo dessa ferramente é alterar os valores incógnitos do campo de contínuos para discretos, para que o deslocamento seja bem definido pelo seu valor sobre a posição cada nó, e que, por sobre o domínio de cada elemento, o campo seja interpolado. Esses valores discretos desconhecidos do campo nos nós, em que o campo tem "liberdade" pra variar, denominam-se \emph{graus de liberdade}. \cite{LOGAN}

O CST, por exemplo, tem seis graus de liberdade, uma vez que para cada nó, o vetor de deslocamento têm três componentes. Os problemas abordados aqui têm sempre três graus de liberdade por nó.

Define-se, então, a função de deslocamento sobre um elemento, representado pela figura \ref{fig:CST}, assim como a proposta linear de interpolação,

\begin{equation}
    \bm{\varphi}^{(e)} = \begin{Bmatrix}
        u(x,y) \\ v(x,y) 
    \end{Bmatrix}^{(e)} = \begin{Bmatrix}
        a_1 + a_2 x + a_3 y \\ b_1 + b_2 x + b_3 y 
    \end{Bmatrix}^{(e)}.
\end{equation}
Nesse sentido, bidimensional, $\bm{\varphi}$ é uma função vetorial de campo que mapeia cada ponto do sólido para seu respectivo deslocamento nos eixos do sistema $xy$ ($u$ e $v$ respectivamente).

\begin{figure}
	\centering
    \caption{Um triângulo de deformações constantes (CST).}
    \begin{tikzpicture}
        \begin{axis}[
                xmin = -1.5, xmax = 1.5,
                ymin = -1, ymax = 1.3, 
                width = 16 cm,
                axis lines = left,
                xticklabels = {,,},
                yticklabels = {,,},
                axis line style = thick,
            ]
            \draw[->] (0.3537131,-0.7543531) -- ++(1 cm, 0 cm) node[right] {$u_i$};
            \draw[->] (0.3537131,-0.7543531) -- ++(0 cm, 1 cm) node[above] {$v_i$};
            
            \draw[->] (-0.1558111,0.798229)  -- ++(1 cm, 0 cm) node[right] {$u_j$};
            \draw[->] (-0.1558111,0.798229)  -- ++(0 cm, 1 cm) node[above] {$v_j$};

            \draw[->] (-0.7003684,-0.2899937) -- ++(1 cm, 0 cm) node[right] {$u_k$};
            \draw[->] (-0.7003684,-0.2899937) -- ++(0 cm, 1 cm) node[above] {$v_k$};

            \draw[blue, ultra thick, fill = blue, fill opacity = 0.1] 
                   (0.3537131,-0.7543531)  node[circle, draw, inner sep=1pt, fill=white, thin, scale = 0.9, fill opacity = 1] {$i$} 
                -- (-0.1558111,0.798229)   node[circle, draw, inner sep=1pt, fill=white, thin, scale = 0.9, fill opacity = 1] {$j$} 
                -- (-0.7003684,-0.2899937) node[circle, draw, inner sep=1pt, fill=white, thin, scale = 0.9, fill opacity = 1] {$k$} 
                -- cycle;
            \draw (-0.2,-0.1) node[scale = 1.5, opacity = 0.5, blue] {$\Omega^{(e)}$};
            \draw (-0.65,0.5) node[scale = 1.5, opacity = 1, blue] {$\partial\Omega^{(e)}$};
        \end{axis}
    \end{tikzpicture}
    \label{fig:CST}
	\fonte{\me{2022}}
\end{figure}

Para determinar as constantes $a$ e $b$, e termos dos deslocamentos nodais basta aplicar a condição de que em cada nó a função deve assumir o valor do deslocamento respectivo. Isto é, analisando somente a componente $x$, ou seja, $u(x,y)$, temos que

\begin{align}
    u(x_i, y_i) &= u_i &= a_1 + a_2 x_i + a_3 y_i, \\
    u(x_h, y_i) &= u_j &= a_1 + a_2 x_j + a_3 y_j, \\
    u(x_i, y_i) &= u_k &= a_1 + a_2 x_k + a_3 y_k,
\end{align}
em que $u_i$ é o valor do deslocamento nodais $i$, assim como $x_i$ e $y_i$ é sua posição sobre o domínio $\Omega$.
 
Reescrevendo esse sistema na forma matricial, temos que

\begin{equation}
    \begin{bmatrix}
        1 & x_i & y_i \\
        1 & x_j & y_j \\
        1 & x_k & y_k \\
    \end{bmatrix}
    \begin{bmatrix}
        a_1 \\ a_2 \\ a_3
    \end{bmatrix}
    = \begin{Bmatrix}
        u_i \\ u_j \\ u_k
    \end{Bmatrix} \implies
    \begin{Bmatrix}
        a_1 \\ a_2 \\ a_3
    \end{Bmatrix} =
    \frac{1}{2A}
    \begin{bmatrix}
        \alpha_i & \alpha_j & \alpha_k \\
        \beta_i & \beta_j & \beta_k \\
        \gamma_i & \gamma_j & \gamma_k \\
    \end{bmatrix}
    \begin{Bmatrix}
        u_i \\ u_j \\ u_k
    \end{Bmatrix},
    \label{eq:matriz_x}
\end{equation}

sendo que\footnote{É fácil demonstrar que esse sistema sempre é possível e determinado apenas observando o fato de que as posições dos nós são distintas e não colineares, a final, os elementos são triangulares.}

\begin{equation}
    \frac{1}{2A}
    \begin{bmatrix}
        \alpha_i & \alpha_j & \alpha_k \\
        \beta_i & \beta_j & \beta_k \\
        \gamma_i & \gamma_j & \gamma_k \\
    \end{bmatrix} = 
    \begin{bmatrix}
        1 & x_i & y_i \\
        1 & x_j & y_j \\
        1 & x_k & y_k \\
    \end{bmatrix}^{-1} = \bm{X}^{-1},
\end{equation}
em que $A$ é área do elemento triangular. \footnote{Essa forma de escrever a inversa de $\bm{X}$ é interessante pois simplifica os termos $\alpha$, $\beta$ e $\gamma$ pelo determinante $2A$.}

Deste modo, a função de interpolação para $u(x,y)$ pode ser descrita em termos dos deslocamentos nodais na forma, utilizando o sistema \ref{eq:matriz_x},

\begin{equation}
    u(x,y) = \begin{bmatrix}
        1 & x & y
    \end{bmatrix} 
    \begin{Bmatrix}
        a_1 \\ a_2 \\ a_3
    \end{Bmatrix} = \begin{bmatrix}
        1 & x & y
    \end{bmatrix}  \frac{1}{2A}
    \begin{bmatrix}
        \alpha_i & \alpha_j & \alpha_k \\
        \beta_i & \beta_j & \beta_k \\
        \gamma_i & \gamma_j & \gamma_k \\
    \end{bmatrix}
    \begin{Bmatrix}
        u_i \\ u_j \\ u_k
    \end{Bmatrix}.
\end{equation}
Expandido essas expressões, multiplicando as matrizes e rearranjado os termos, temos que

\begin{equation}
    u(x,y) = \frac{1}{2A} \left[ \alpha_i + \beta_i x + \gamma_i y \right] u_i + \frac{1}{2A} \left[ \alpha_j + \beta_j x + \gamma_j y \right] u_j + \frac{1}{2A} \left[ \alpha_k + \beta_k x + \gamma_k y \right] u_k.
    \label{eq:funcao_u}
\end{equation}

É possível, também, definir a função de interpolação para a componente $v(x,y)$, de modo análogo, obtendo, apenas substituindo a função $u$ por $v$ nas equações anteriores, que as mesmas relações de interpolações são válidas também para a outra componente de $\bm{\varphi}$. Então, 

\begin{equation}
    v(x,y) = \frac{1}{2A} \left[ \alpha_i + \beta_i x + \gamma_i y \right] v_i + \frac{1}{2A} \left[ \alpha_j + \beta_j x + \gamma_j y \right] v_j + \frac{1}{2A} \left[ \alpha_k + \beta_k x + \gamma_k y \right] v_k.
    \label{eq:funcao_v}
\end{equation}

Para simplificar a notação das equações \ref{eq:funcao_u} e \ref{eq:funcao_v}, define-se funções $N$ da forma

\begin{align}
    N_i &= \frac{1}{2A} \left[ \alpha_i + \beta_i x + \gamma_i y \right], \\
    N_j &= \frac{1}{2A} \left[ \alpha_j + \beta_j x + \gamma_j y \right], \\
    N_k &= \frac{1}{2A} \left[ \alpha_k + \beta_k x + \gamma_k y \right].
\end{align}

Por fim, $\bm{\varphi}$ pode ser reescrito na forma matricial, em termos dessas funções $N$ e dos deslocamentos nodais e $u$ e $v$, como

\begin{equation}
    \bm{\varphi}^{(e)} = \begin{Bmatrix}
        u(x,y) \\ v(x,y)
    \end{Bmatrix}^{(e)} = \begin{bmatrix}
        N_i & 0 & N_j & 0 & N_k & 0 \\
        0 & N_i & 0 & N_j & 0 & N_k
    \end{bmatrix} \begin{Bmatrix}
        u_i \\ v_i \\ u_j \\ v_j \\ u_k \\ v_k
    \end{Bmatrix} = \bm{N} \bm{U}^{(e)},
\end{equation}
em que $\bm{N}$ é a matrix de funções de interpolação, e $\bm{U}^{(e)}$ é o vetor de deslocamentos nodais do elemento.


\section{As Relações de Tensão-Deformação-Deslocamento}

No caso bidimensional, o vetor de deformação, na notação de Voigt, é dado por, conforme definido no capítulo anterior,

\begin{equation}
    \{\epsilon\} = \begin{Bmatrix}
        \epsilon_{xx} \\ \epsilon_{yy} \\ \gamma_{xy}
    \end{Bmatrix} =
    \begin{Bmatrix}
        \frac{\partial u}{\partial x} \\ \frac{\partial v}{\partial y} \\ \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}
    \end{Bmatrix}
\end{equation}

Aplicando nessas derivadas parciais as funções de interpolação de $\bm{\varphi}$, das equações \ref{eq:funcao_u} e \ref{eq:funcao_v}, temos que, conforme \citeshort{LOGAN},

\begin{align}
    \frac{\partial u}{\partial x} &= \frac{1}{2A} \left[ \beta_i u_i + \beta_j u_j + \beta_k u_k\right],  \\
    \frac{\partial v}{\partial y} &= \frac{1}{2A} \left[ \gamma_i v_i + \gamma_j v_j + \gamma_k v_k\right],  \\
    \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} &= \frac{1}{2A} \left[ \gamma_i u_i + \gamma_j u_j + \gamma_k u_k + \beta_i v_i + \beta_j v_j + \beta_k v_k \right].
\end{align}

Utilizando essas equações, é possível reescrever o vetor de deformação $\{\epsilon\}$ em termos dos coeficientes $\beta$ e $\gamma$, como também do vetor de deslocamentos nodais do elemento $\{U\}^{(e)}$, na forma

\begin{equation}
    \{\epsilon\} = \frac{1}{2A} \begin{bmatrix}
        \beta_i & 0 & \beta_j & 0 & \beta_k & 0 \\
        0 & \gamma_i & 0 & \gamma_j & 0 & \gamma_k \\
        \gamma_i & \beta_i & \gamma_j & \beta_j & \gamma_k & \beta_k
    \end{bmatrix} \begin{Bmatrix}
        u_i \\ v_i \\ u_j \\ v_j \\ u_k \\ v_k
    \end{Bmatrix} = \frac{1}{2A} \bm{B} \bm{U}^{(e)}.
    \label{eq:deformacao_deslocamento}
\end{equation}

A matrix $\bm{B}$ é uma função das coordenadas dos nós do elemento, e relaciona o vetor de deslocamentos nodais do elemento $\bm{U}^{(e)}$ com o vetor de deformações $\{\epsilon\}$, assim como é constante ao longo de todo o elemento, o que é devido pela escolha de funções lineares de interpolação. Por causa dessa propriedade, esse elemento é denominado triângulo de deformações constantes, ou CST (\emph{Constant Strain Triangle}).

Por fim, ao passo que a relação entre deformação e tensão é dada pela Lei de Hooke generalizada, na forma da matriz constitutiva $\bm{C}$ (por conveniência, a matriz constitutiva será expressa sem a notação usual $[C]$), expressar a relação entre tensão e deslocamento, ou tensão-Deformação-Deslocamento, é simplesmente uma questão de multiplicar a matriz constitutiva pela matriz $\bm{B}$, obtendo assim a relação

\begin{equation}
    \{\sigma\} = \bm{C} \bm{B} \bm{U}^{(e)}.
    \label{eq:relacao_tensao_deslocamento}
\end{equation}


\section{A Matriz de Rigidez Local}

A matriz de rigidez local é uma matriz quadrada, simétrica, que relaciona o vetor de forças nodais $\bm{F}^{(e)}$ com o vetor de deslocamentos nodais $\bm{U}^{(e)}$, na forma
\begin{equation}
    \bm{F}^{(e)} = \bm{K}^{(e)} \bm{U}^{(e)},
\end{equation}
cuja derivação é feita aplicando a equação de governo, o equilíbrio estático nesse caso, sobre o elemento, utilizando as funções de interpolação para o campo de deslocamentos. \cite{LOGAN}

$\bm{F}^{(e)}$ é um vetor que armazena as forças aplicadas sobre os nós do elemento, analogamente a $\bm{U}^{(e)}$ que armazena os deslocamentos nodais, e tem a forma

\begin{equation}
    \bm{F}^{(e)} = \begin{Bmatrix}
        fx_i \\ fy_j \\ fx_j \\ fy_j \\ fx_k \\ fy_k
    \end{Bmatrix}.
\end{equation}

Um dos métodos para derivar essa matriz é utilizar o \emph{Princípio dos Trabalhos Virtuais}, que pode ser enunciado como:

\begin{citacao}
    Se um corpo deformável em equilíbrio é submetido a deslocamentos virtuais arbitrários (imaginários) associados a uma deformação compatível do corpo, o trabalho virtual das forças externas no corpo é igual à energia virtual de deformação das tensões internas. \cite[pág. 876, tradução livre]{LOGAN}
\end{citacao}

Nesse contexto, o trabalho virtual interno é causado por uma deformação do próprio corpo, denotada $\delta \bm{\epsilon}$, enquanto o trabalho virtual externo, por sua vez, é causado diretamente por um deslocamento virtual das forças que atuam sobre as fronteiras do corpo, denotado $\delta \bm{u}$. Em um corpo elástico, modelado pela Lei de Hooke, o trabalho virtual interno pode ser descrito em termos do deslocamento, como a energia armazenada na forma elástica, a fim de desenvolver as equações de equilíbrio estático apresentadas a seguir. \footnote{A notação $\delta$ se refere a um variacional, que representa uma variação infinitesimal sobre o todo o contínuo da função, de modo que seja nulo na região em que são aplicadas as condições de contorno. O cálculo variacional, entretanto, não é abordado diretamente nesta monografia.}


Seja um elemento triangular, como da figura \ref{fig:CST_carregamentos}, que sofre um deslocamento virtual $\delta \bm{U}^{(e)}$. De acordo com \citeshort{Zin}, o trabalho interno do elemento é dado por\footnote{Poder escrever a energia interna desta forma simples é devido à escolha de que, na notação de Voigt do tensor de deformação, foi utilizado a convenção de $\gamma = 2 \epsilon$.}

\begin{equation}
    \mathcal{U} = \int_{\Omega^{(e)}} \delta \{\epsilon\}^t \{\sigma\} dV,
\end{equation}

Utilizando as relações de tensão-deformação-deslocamento, descritas nas equações \ref{eq:deformacao_deslocamento} e \ref{eq:relacao_tensao_deslocamento}, temos que\footnote{Utilizando também a propriedade de transposição do produto de matrizes, $(\bm{A}\bm{B})^t = \bm{B}^t \bm{A}^t$.}

\begin{equation}
    \mathcal{U} = \int_{\Omega^{(e)}} (\bm{B} \delta \bm{U}^{(e)})^t \bm{C} \bm{B} \bm{U}^{(e)} dV
    \implies \mathcal{U} = \delta (\bm{U}^{(e)})^t \int_{\Omega^{(e)}} \bm{B}^t \bm{C} \bm{B} dV \bm{U}^{(e)}.
\end{equation}

\begin{figure}
	\centering
    \caption{Um triângulo de deformações constantes sob carregamentos (CST) sob carregamentos uniformes.}
    \begin{tikzpicture}
        \usetikzlibrary{calc}
        \begin{axis}[
                xmin = -1.5, xmax = 1.5,
                ymin = -1, ymax = 1.3, 
                width = 16 cm,
                axis lines = left,
                xticklabels = {,,},
                yticklabels = {,,},
                axis line style = thick,
            ]

            \coordinate  (i) at (0.3537131,-0.7543531);
            \coordinate  (j) at (-0.1558111,0.798229);
            \coordinate  (k) at (-0.7003684,-0.2899937);
            \coordinate  (ji) at ($(i)-(j)$);

            \draw[red, ultra thick, fill=red, fill opacity = 0.1]
            (j) --++ (1 cm, 0 cm) -- ($(i) + (1cm,0cm)$) -- (i) -- cycle;

            \draw[->, red, thick] (j) ++ ($ 0.0*(i)-0.0*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.05*(i)-0.05*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.1*(i)-0.1*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.15*(i)-0.15*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.2*(i)-0.2*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.25*(i)-0.25*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.3*(i)-0.3*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.35*(i)-0.35*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.4*(i)-0.4*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.45*(i)-0.45*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.5*(i)-0.5*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.55*(i)-0.55*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.6*(i)-0.6*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.65*(i)-0.65*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.7*(i)-0.7*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.75*(i)-0.75*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.8*(i)-0.8*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.85*(i)-0.85*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.9*(i)-0.9*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 0.95*(i)-0.95*(j)$) --++ (1cm, 0cm);
            \draw[->, red, thick] (j) ++ ($ 1.0*(i)-1.0*(j)$) --++ (1cm, 0cm);

            \draw[->] (i) -- ++(1 cm, 0 cm) node[right] {$f_{xi}$};
            \draw[->] (i) -- ++(0 cm, 1 cm) node[above] {$f_{yi}$};
            
            \draw[->] (-0.1558111,0.798229)  -- ++(1 cm, 0 cm) node[right] {$f_{xj}$};
            \draw[->] (-0.1558111,0.798229)  -- ++(0 cm, 1 cm) node[above] {$f_{yj}$};

            \draw[->] (-0.7003684,-0.2899937) -- ++(1 cm, 0 cm) node[right] {$f_{xk}$};
            \draw[->] (-0.7003684,-0.2899937) -- ++(0 cm, 1 cm) node[above] {$f_{yk}$};





            \draw[blue, ultra thick, fill = blue, fill opacity = 0.1] 
                   (i)  node[circle, draw, inner sep=1pt, fill=white, thin, scale = 0.9, fill opacity = 1] {$i$} 
                -- (j)   node[circle, draw, inner sep=1pt, fill=white, thin, scale = 0.9, fill opacity = 1] {$j$} 
                -- (k) node[circle, draw, inner sep=1pt, fill=white, thin, scale = 0.9, fill opacity = 1] {$k$} 
                -- cycle;
            \draw (-0.2,-0.1) node[scale = 1.5, opacity = 0.5, blue] {$\Omega^{(e)}$};
            \draw (-0.65,0.5) node[scale = 1.5, opacity = 1, blue] {$\partial\Omega^{(e)}$};
            \draw ($0.5*(i)+0.5*(j)$) ++ (1.5 cm, 0 cm) node[red, scale=1.5] {$\bm{t}_{ij}$};
        \end{axis}
    \end{tikzpicture}
    \label{fig:CST_carregamentos}
	\fonte{\me{2022}}
\end{figure}


O trabalho desenvolvido pelas forças externas é dado, também de acordo com \citeshort{Zin}, pelo produto dos deslocamento nodais e das forças nodais, na forma

\begin{equation}
    \mathcal{W} = \delta (\bm{U}^{(e)})^t \bm{F}^{(e)}.
\end{equation}

Igualando as duas parcelas de trabalho, temos que

\begin{equation}
    \mathcal{U} =  \mathcal{W}\implies
    \delta (\bm{U}^{(e)})^t \int_{\Omega^{(e)}} \bm{B}^t \bm{C} \bm{B} dV \bm{U}^{(e)} = \delta (\bm{U}^{(e)})^t \bm{F}^{(e)}.
\end{equation}

Portanto, 

\begin{equation}
    \bm{F}^{(e)} = \int_{\Omega^{(e)}} \bm{B}^t \bm{C} \bm{B} dV \bm{U}^{(e)}.
    \label{eq:forca_equivalente}
\end{equation}

Comparando com a forma da equação \ref{eq:sistema_global}, fica evidente que a matriz de rigidez local é dada por

\begin{equation}
    \bm{K}^{(e)} = \int_{\Omega^{(e)}} \bm{B}^t \bm{C} \bm{B} dV.
\end{equation}

O elemento tratado aqui é o CST, portanto, a matriz $\bm{B}$ é constante em todo o domínio $\Omega^{(e)}$, como também é constante a matriz constitutiva $\bm{C}$. A integral, portanto, não precisa ser computada em um sistema local, pois todos os termos que a compõe são constantes. Logo, a matriz de rigidez local pode ser simplificada ainda mais, tornando-se, de acordo com \citeshort{LOGAN}

\begin{equation}
    \bm{K}^{(e)} = \bm{B}^t \bm{C} \bm{B} \int_{\Omega^{(e)}} dV = \bm{B}^t \bm{C} \bm{B} V,
    \label{eq:matriz_local}
\end{equation}
em que $V$ é o volume do elemento, definido, no caso bidimensional, por $V = A d$, em que $d$ é a espessura.

Essa matriz pode ser lida como uma lista de causa e efeito. Enquanto a linha da matriz representa onde que o efeito do deslocamento é aplicado, a força no caso, a coluna informa qual é o deslocamento, o grau de liberdade, que o causa. \cite{LOGAN}

Outra forma de derivar essa relação diretamente da equação de equilíbrio estático é por meio do método de Galerkin, em que as bases da função de interpolação são as mesmas da função de ponderação, utilizando a chamada formulação fraca da equação de governo. Esse método leva à mesma formulação mostrada acima.

Vale ressaltar que não foi preciso definir um sistema local de coordenadas para derivar essas relações, uma vez que o elemento tradado aqui, como também o tetraedro (tratado mais adiante), tem funções de interpolação simples o suficiente que um sistema orientado a cada elemento não é necessário. Elementos mais sofisticados necessitam, por uma questão de manipulação algébrica, de um sistema de referência local. Esses elementos não são tratados aqui.

\section{Matriz de Rigidez Global e Condições de Contorno}

Para cada elemento do domínio é realizado o procedimento descrito na seção anterior, de encontrar a matriz de rigidez local que descreve o equilíbrio do elemento em termos das forças externas e do campo de deslocamento sobre os nós. Para resolver o problema, encontrar os deslocamentos de todos os nós, é necessário justapor essas matrizes locais em uma matriz global, ou seja,
\begin{equation}
    \bm{K} = \sum_{e} \bm{K}^{(e)}.
\end{equation}
Nesse contexto, $\Sigma$ representa, não uma soma ordinária, mas sim a sobreposição dos efeitos de rigidez sobre os nós. \cite{LOGAN}

Em cada elemento, a matriz local de rigidez $\bm{K}^{(e)}$ define a interação de forças e deslocamentos entre os graus de liberdade dos nós. Analisando a estrutura como um todo, cada nó pode pertencer a vários elementos, pois é assim que a malha é constituída. O efeito de rigidez, então, sobre cada nó é a soma dos efeitos de todos os elementos que o contém. Isso vale para os deslocamentos nodais, como para as forças nodais. O procedimento, portanto, de montagem da matriz global de rigidez é a soma das matrizes locais de rigidez sobre as posições dos graus de liberdade respe    ctivos das matrizes locais (mapeamento local-global).

Seja um sólido $\mathcal{B}$ discretizado por uma malha composta de cinco nós, formando três elementos, conforme a figura \ref{fig:exemplo_matriz_global}, engastado na superfície inferior do elemento azulado e sujeito a uma força \textcolor{purple}{$f$} concentrada no nó $2$, como também um carregamento distribuído \textcolor{orange}{$t$} na superfície entre os nós $4$ e $5$.


\input{Figuras/exemplo_matriz_global.tex}

As matrizes locais de rigidez desses elementos são quadradas $6 \times 6$, pois no CST existem três graus de liberdade, dois para cada nó, referente ao deslocamento nas direções de $x$ e $y$. Os sistemas locas, então, para elemento da figura \ref{fig:exemplo_matriz_global}, têm a forma

\begin{align}
    \color{blue} \begin{bmatrix}
        k_{11} & k_{12} & k_{13} & k_{14} & k_{15} & k_{16} \\
        k_{21} & k_{22} & k_{23} & k_{24} & k_{25} & k_{26} \\
        k_{31} & k_{32} & k_{33} & k_{34} & k_{35} & k_{36} \\
        k_{41} & k_{42} & k_{43} & k_{44} & k_{45} & k_{46} \\
        k_{51} & k_{52} & k_{53} & k_{54} & k_{55} & k_{56} \\
        k_{61} & k_{62} & k_{63} & k_{64} & k_{65} & k_{66} \\
    \end{bmatrix}^{(1)}
    \color{black}
    \begin{Bmatrix}
        u_1 \\ v_1 \\ u_2 \\ v_2 \\ u_3 \\ v_3
    \end{Bmatrix}
    &=
    \begin{Bmatrix}
        f_{x1} \\ f_{y1} \\ f_{x2} \\ f_{y2} \\ f_{x3} \\ f_{y3}
    \end{Bmatrix} \iff \color{blue} \bm{K}^{(e)} \bm{U}^{(e)} = \bm{F}^{(e)}, \\
    \color{red} \begin{bmatrix}
        k_{11} & k_{12} & k_{13} & k_{14} & k_{15} & k_{16} \\
        k_{21} & k_{22} & k_{23} & k_{24} & k_{25} & k_{26} \\
        k_{31} & k_{32} & k_{33} & k_{34} & k_{35} & k_{36} \\
        k_{41} & k_{42} & k_{43} & k_{44} & k_{45} & k_{46} \\
        k_{51} & k_{52} & k_{53} & k_{54} & k_{55} & k_{56} \\
        k_{61} & k_{62} & k_{63} & k_{64} & k_{65} & k_{66} \\
    \end{bmatrix}^{(2)}
    \color{black}
    \begin{Bmatrix}
        u_2 \\ v_2 \\ u_3 \\ v_3 \\ u_4 \\ v_4
    \end{Bmatrix}
    &=
    \begin{Bmatrix}
        f_{x2} \\ f_{y2} \\ f_{x3} \\ f_{y3} \\ f_{x4} \\ f_{y4}
    \end{Bmatrix} \iff \color{red} \bm{K}^{(e)} \bm{U}^{(e)} = \bm{F}^{(e)}, \\
    \color{green} \begin{bmatrix}
        k_{11} & k_{12} & k_{13} & k_{14} & k_{15} & k_{16} \\
        k_{21} & k_{22} & k_{23} & k_{24} & k_{25} & k_{26} \\
        k_{31} & k_{32} & k_{33} & k_{34} & k_{35} & k_{36} \\
        k_{41} & k_{42} & k_{43} & k_{44} & k_{45} & k_{46} \\
        k_{51} & k_{52} & k_{53} & k_{54} & k_{55} & k_{56} \\
        k_{61} & k_{62} & k_{63} & k_{64} & k_{65} & k_{66} \\
    \end{bmatrix}^{(3)}
    \color{black}
    \begin{Bmatrix}
        u_3 \\ v_3 \\ u_5 \\ v_5 \\ u_4 \\ v_4
    \end{Bmatrix}
    &=
    \begin{Bmatrix}
        f_{x3} \\ f_{y3} \\ f_{x5} \\ f_{y5} \\ f_{x4} \\ f_{y4}
    \end{Bmatrix} \iff \color{green} \bm{K}^{(e)} \bm{U}^{(e)} = \bm{F}^{(e)}.
\end{align}

A montagem do sistema global é somar essas matrizes de rigidez sobre os graus de liberdade. Observemos que o primeiro nó só faz parte de um elemento, o \textcolor{blue}{azul}, portanto sua rigidez só tem contribuição desse elemento; o nó $3$, por sua vez, pertence aos três elementos (\textcolor{blue}{azul}, \textcolor{red}{vermelho} e \textcolor{green}{verde}), e, portanto, seu termo de rigidez tem contribuição de todos eles. Realizando esse procedimento, é possível montar a matriz global de rigidez, utilizando, para tanto, a notação dos vetores de deslocamentos nodais $\bm{U}$ e de forças nodais $\bm{F}$.

A matriz de rigidez global é quadrada $10 \times 10$, pois existem cinco nós, com dois graus de liberdade cada, e é dada por
\begin{landscape}
    \begin{equation}
            \begin{bmatrix}
                \textcolor{blue}{k_{11}} &  \textcolor{blue}{k_{12}} &  \textcolor{blue}{k_{13}}                           &  \textcolor{blue}{k_{14}}                             &  \textcolor{blue}{k_{15}}                                                       &  \textcolor{blue}{k_{16}}                                                       & 0                                                    & 0                                                    & 0                          & 0                          \\
                \textcolor{blue}{k_{21}} &  \textcolor{blue}{k_{22}} &  \textcolor{blue}{k_{23}}                           &  \textcolor{blue}{k_{24}}                             &  \textcolor{blue}{k_{25}}                                                       &  \textcolor{blue}{k_{26}}                                                       & 0                                                    & 0                                                    & 0                          & 0                          \\
                \textcolor{blue}{k_{31}} &  \textcolor{blue}{k_{32}} &  \textcolor{blue}{k_{33}} + \textcolor{red}{k_{11}} &  \textcolor{blue}{k_{34}} + \textcolor{red}{k_{12}}   &  \textcolor{blue}{k_{35}} + \textcolor{red}{k_{13}}                             &  \textcolor{blue}{k_{36}} + \textcolor{red}{k_{14}}                             &  \textcolor{red}{k_{15}}                             &  \textcolor{red}{k_{16}}                             & 0                          & 0                          \\
                \textcolor{blue}{k_{41}} &  \textcolor{blue}{k_{42}} &  \textcolor{blue}{k_{43}} + \textcolor{red}{k_{21}} &  \textcolor{blue}{k_{44}} + \textcolor{red}{k_{22}}   &  \textcolor{blue}{k_{45}} + \textcolor{red}{k_{23}}                             &  \textcolor{blue}{k_{46}} + \textcolor{red}{k_{24}}                             &  \textcolor{red}{k_{25}}                             &  \textcolor{red}{k_{26}}                             & 0                          & 0                          \\
                \textcolor{blue}{k_{51}} &  \textcolor{blue}{k_{52}} &  \textcolor{blue}{k_{53}} + \textcolor{red}{k_{31}} &  \textcolor{blue}{k_{54}} + \textcolor{red}{k_{32}}   &  \textcolor{blue}{k_{55}} + \textcolor{red}{k_{33}} + \textcolor{green}{k_{11}} &  \textcolor{blue}{k_{56}} + \textcolor{red}{k_{34}} + \textcolor{green}{k_{12}} &  \textcolor{red}{k_{35}} + \textcolor{green}{k_{13}} &  \textcolor{red}{k_{36}} + \textcolor{green}{k_{14}} &  \textcolor{green}{k_{15}} &  \textcolor{green}{k_{16}} \\
                \textcolor{blue}{k_{61}} &  \textcolor{blue}{k_{62}} &  \textcolor{blue}{k_{63}} + \textcolor{red}{k_{41}} &  \textcolor{blue}{k_{64}} + \textcolor{red}{k_{42}}   &  \textcolor{blue}{k_{65}} + \textcolor{red}{k_{43}} + \textcolor{green}{k_{21}} &  \textcolor{blue}{k_{66}} + \textcolor{red}{k_{44}} + \textcolor{green}{k_{22}} &  \textcolor{red}{k_{45}} + \textcolor{green}{k_{23}} &  \textcolor{red}{k_{46}} + \textcolor{green}{k_{24}} &  \textcolor{green}{k_{25}} &  \textcolor{green}{k_{26}} \\
                0                        & 0                         &  \textcolor{red}{k_{51}} &  \textcolor{red}{k_{52}} &  \textcolor{red}{k_{53}} + \textcolor{green}{k_{31}}  &  \textcolor{red}{k_{54}} + \textcolor{green}{k_{32}}                            &  \textcolor{red}{k_{55}} + \textcolor{green}{k_{33}}                            &  \textcolor{red}{k_{56}} + \textcolor{green}{k_{34}} &  \textcolor{green}{k_{35}}                           &  \textcolor{green}{k_{36}} & 0                          \\
                0                        & 0                         &  \textcolor{red}{k_{61}} &  \textcolor{red}{k_{62}} &  \textcolor{red}{k_{63}} + \textcolor{green}{k_{41}}  &  \textcolor{red}{k_{64}} + \textcolor{green}{k_{42}}                            &  \textcolor{red}{k_{65}} + \textcolor{green}{k_{43}}                            &  \textcolor{red}{k_{66}} + \textcolor{green}{k_{44}} &  \textcolor{green}{k_{45}}                           &  \textcolor{green}{k_{46}} & 0                          \\
                0                        & 0                         & 0                                                   & 0                                                     &  \textcolor{green}{k_{51}}                                                      &  \textcolor{green}{k_{52}}                                                      &  \textcolor{green}{k_{53}}                           &  \textcolor{green}{k_{54}}                           &  \textcolor{green}{k_{55}} &  \textcolor{green}{k_{56}} \\
                0                        & 0                         & 0                                                   & 0                                                     &  \textcolor{green}{k_{61}}                                                      &  \textcolor{green}{k_{62}}                                                      &  \textcolor{green}{k_{63}}                           &  \textcolor{green}{k_{64}}                           &  \textcolor{green}{k_{65}} &  \textcolor{green}{k_{66}} 
            \end{bmatrix}
            \begin{Bmatrix}
                0 \\ 0 \\ u_2 \\ v_2 \\ 0 \\ 0 \\ u_4 \\ v_4 \\ u_5 \\ v_5
            \end{Bmatrix} = 
            \begin{Bmatrix}
                R_{x1} \\ R_{y1} \\ 0 \\ \textcolor{purple}{f} \\ R_{x3} \\ R_{y3} \\ \frac{1}{2} \ell_{4-5} \textcolor{orange}{t} \\ 0 \\ \frac{1}{2} \ell_{4-5} \textcolor{orange}{t} \\ 0
            \end{Bmatrix}.
        \label{eq:sistema_global_montado}
    \end{equation}
\end{landscape}
Nas duas primeiras linhas do sistema, que representam as forças nodais sobre o primeiro nó, é possível notar que somente os deslocamentos do elemento azulado que impactam diretamente. Nos graus de $u_3$ e $u_v$, fica evidente que todos os elementos contribuem para as forças nodais do nó $3$, conforme descrito anteriormente.

Um outro passo nessa montagem do sistema global é a aplicação das condições de contorno. As condições de contorno, tradas aqui, podem ser dividas em dois tipos: 

\begin{enumerate}
    \item de Dirichlet, ou de primeiro tipo, e
    \item de Neumann, ou de segundo tipo.
\end{enumerate}

 As condições de Dirichlet são aquelas que definem valores da variável incógnita na fronteira do domínio. Já as de Neumann, são aquelas que definem valores de contorno sobre a derivada da variável incógnita nas fronteiras do domínio \cite{sinan}. Aqui, as condições de contorno de Dirichlet são restrições de deslocamento, enquanto as condições de Neumann são carregamentos aplicados sobre a estrutura.
 
As condições de contorno sobre os deslocamentos, então, dividem os graus de liberdade entre 

\begin{enumerate}
    \item livre;
    Quando não há informação prévia de seus valores, isto é, o campo pode variar livremente.
    \item prescritos;
    prescritos quando há informação prévia de seus valores, e portanto, não podem variar.
    \cite{LOGAN}
\end{enumerate}

Um engaste, por exemplo, gera condições de contorno de Dirichlet, definindo graus de liberdade prescritos, pois impõe que o deslocamento naquela região do sólido é nulo. Um deslocamento conhecido, também o faz, determinando que os graus correspondentes recebam o valor deslocado.

O vetor de forças $\bm{F}$ é nulo em regra sobre os graus de liberdade livres, pois essa entidade representa as forças externas sobre o elemento. Entretanto, como no MEF os deslocamentos são discretizados nos nós, o mesmo é feito com os carregamentos. Quando se aplicam condições de contorno de Neumann, os graus correspondentes devem receber forças nodais equivalentes, de forma que representem os carregamentos por forças externas concentradas nos nó. Pode-se encontrar as forças nodais equivalentes utilizando o mesmo método da seção anterior: o princípio dos trabalhos virtuais, fazendo com que o trabalho de carregamentos sobre a fronteira de um elemento $\partial \Omega^{(e)}$, causado por um deslocamento virtual $\delta \bm{U}^{(e)}$, seja igual ao trabalho da forças nodais equivalentes. Em termos matemáticos, de acordo com \citeshort{Zin},
\begin{equation}
    \delta (\bm{U}^{(e)})^t \bm{F}^{(e)} = \int_{\partial \Omega^{(e)}} (\bm{N}\bm{U}^{(e)})^t \bm{t} d \ell,
\end{equation}
em que $\bm{t}$ é o vetor do carregamento sobre a fronteira do elemento, na forma
\begin{equation}
    \bm{t} = \begin{Bmatrix}
        t_x(x,y) \\ t_y(x,y),
    \end{Bmatrix}.
\end{equation}
e $d\ell$ é o infinitesimal de área da fronteira do elemento.

Aqui os carregamentos são constantes sobre as fronteiras dos elementos, isto é, são carregamentos distribuídos e uniformes. Deste modo, a equação anterior pode ser simplificada para

\begin{equation}
    \delta (\bm{U}^{(e)})^t \bm{F}^{(e)} = \delta \bm{U}^{(e)} \int_{\partial \Omega^{(e)}} \bm{N}^t d\ell \bm{t}. 
\end{equation}
Portanto, as forças nodais equivalentes, devidas a carregamentos uniformes sobre a fronteira do elemento, é dada por
\begin{equation}
    \bm{F}^{(e)} = \int_{\partial \Omega^{(e)}} \bm{N}^t dl \bm{t}.
\end{equation}

No elemento CST, pela simplicidade das funções de interpolação, é possível realizar essa integração analiticamente. A solução mostra que o carregamento uniforme sobre a fronteira do elemento é equivalente à distribuição dessa carga duas forças nodais iguais, agindo nas extremidades da face em que atua o carregamento, ou seja, de acordo com \cite{Onate},
\begin{equation}
    \bm{F}^{(e)}_{\bm{t}} = \frac{1}{2} l^{(e)} \bm{t}
\end{equation}
em que $\bm{F}^{(e)}_{\bm{t}}$ são as forças equivalentes que compreendem a fronteira em que o carregamento $\bm{t}$ é aplicado, $l^{(e)}$ é o comprimento da fronteira do elemento, e $d$ é a espessura do elemento.

Na equação \ref{eq:sistema_global_montado}, em que foi montado o sistema global, já foram aplicada essas condições de contorno. Pode-se notar que os deslocamentos vinculados à fronteira compostas pelos nós $1$ e $3$ são nulos, pois alí se faz um engaste. A força roxeada \textcolor{purple}{$f$}, agindo sobre o nó $2$, faz-se presente diretamente no vetor de forças nodais, pois já é uma força concentrada em um nó. O carregamento alaranjado \textcolor{orange}{$t$}, por sua vez, foi decomposto em duas parcelas, para os nós $5$ e $4$, seguindo a expressão da equação anterior. 

Vale ressaltar que nos graus de liberdade prescritos as forças nodais desconhecidas são as reações das estruturas, isto é, as forças de reação que as restrições fazem sobre o corpo que se mantenha em equilíbrio. Por conta disso, na equação \ref{eq:sistema_global_montado}, as forças sobre os graus prescritos foram denominadas $R$, de reação.

\subsection{Solução direta do sistema global}

Com a determinação da matriz de rigidez global, as condições de contorno devidamente expressas em graus prescritos e livres (sejam deslocamento ou carregamentos), é possível reescrever o sistema geral da equação \ref{eq:sistema_global} na forma, de acordo com \citeshort{rao},

\begin{equation}
    \begin{bmatrix}
        \bm{K}_{LL} & \bm{K}_{LP} \\
        \bm{K}_{PL} & \bm{K}_{PP}
    \end{bmatrix} 
    \begin{Bmatrix}
        \bm{U}_L \\ \bm{U}_P
    \end{Bmatrix}
    = \begin{Bmatrix}
        \bm{F}_L \\ \bm{F}_P
    \end{Bmatrix},
\end{equation}
Nessa expressão, os graus de liberdade subdividem os vetores $\bm{U}$ e $\bm{F}$ em dois cada um, em prescritos ($\bm{U}_P$ e $\bm{F}_P$), e livres ($\bm{U}_L$ e $\bm{F}_L$). A matriz de rigidez, então, é subdividida em quatro, que relacionam os graus de liberdade prescritos e livros dos deslocamentos e das forças nodais, respectivamente.

Portanto, o sistema global pode ser reescrito mais uma vez em termos dessas submatrizes, como

\begin{align}
    \bm{K}_{LL} \bm{U}_L + \bm{K}_{LP} \bm{U}_P &= \bm{F}_L \\
    \bm{K}_{PL} \bm{U}_L + \bm{K}_{PP} \bm{U}_P &= \bm{F}_P.
\end{align}

Os valores conhecidos desse sistema são os deslocamentos sobre os graus prescritos $\bm{U}_P$, e as forças externas sobre o graus livres $\bm{F}_L$, a final, são as próprias condições de contorno definidas matematicamente pelo MEF. Logo, como o objetivo de resolver o sistema é encontrar os deslocamentos nodais, é possível isolar $\bm{U}_L$ na primeira equação, ou seja,

\begin{align}
    \bm{U}_L &= \bm{K}_{LL}^{-1} (\bm{F}_L - \bm{K}_{LP} \bm{U}_P), \\
    \bm{F}_P &= \bm{K}_{PL} \bm{U}_L + \bm{K}_{PP} \bm{U}_P.
\end{align}
a matriz $\bm{K}_{LL}$ é quadrada, simétrica e sempre possui inversa quando o problema está estaticamente determinado. \cite{rao}

Aplicando essas expressões à equação \ref{eq:sistema_global_montado}, referente ao exemplo da figura \ref{fig:exemplo_matriz_global}, temos que
\begin{landscape}
    \begin{align*}
        \begin{bmatrix}
            \textcolor{blue}{k_{33}} + \textcolor{red}{k_{11}} &  \textcolor{blue}{k_{34}} + \textcolor{red}{k_s{12}} &  \textcolor{red}{k_{15}} &  \textcolor{red}{k_{16}} & 0 & 0 & \\ 
            \textcolor{blue}{k_{43}} + \textcolor{red}{k_{21}} &  \textcolor{blue}{k_{44}} + \textcolor{red}{k_{22}} &  \textcolor{red}{k_{25}} &  \textcolor{red}{k_{26}} & 0 & 0 & \\ 
            \textcolor{red}{k_{51}} &  \textcolor{red}{k_{52}} &  \textcolor{red}{k_{55}} + \textcolor{green}{k_{33}} &  \textcolor{red}{k_{56}} + \textcolor{green}{k_{34}} &  \textcolor{green}{k_{35}} &  \textcolor{green}{k_{36}} & \\ 
            \textcolor{red}{k_{61}} &  \textcolor{red}{k_{62}} &  \textcolor{red}{k_{65}} + \textcolor{green}{k_{43}} &  \textcolor{red}{k_{66}} + \textcolor{green}{k_{44}} &  \textcolor{green}{k_{45}} &  \textcolor{green}{k_{46}} & \\ 
        0 & 0 &  \textcolor{green}{k_{53}} &  \textcolor{green}{k_{54}} &  \textcolor{green}{k_{55}} &  \textcolor{green}{k_{56}} & \\ 
        0 & 0 &  \textcolor{green}{k_{63}} &  \textcolor{green}{k_{64}} &  \textcolor{green}{k_{65}} &  \textcolor{green}{k_{66}} & \\ 
        \end{bmatrix}
        \begin{Bmatrix}
            u_2 \\ v_2 \\ u_4 \\ v_4 \\ u_5 \\ v_5
        \end{Bmatrix} +
        \begin{bmatrix}
            \textcolor{blue}{k_{31}} &  \textcolor{blue}{k_{32}} &  \textcolor{blue}{k_{35}} + \textcolor{red}{k_{13}} &  \textcolor{blue}{k_{36}} + \textcolor{red}{k_{14}} & \\ 
            \textcolor{blue}{k_{41}} &  \textcolor{blue}{k_{42}} &  \textcolor{blue}{k_{45}} + \textcolor{red}{k_{23}} &  \textcolor{blue}{k_{46}} + \textcolor{red}{k_{24}} & \\ 
        0 & 0 &  \textcolor{red}{k_{53}} + \textcolor{green}{k_{31}} &  \textcolor{red}{k_{54}} + \textcolor{green}{k_{32}} & \\ 
        0 & 0 &  \textcolor{red}{k_{63}} + \textcolor{green}{k_{41}} &  \textcolor{red}{k_{64}} + \textcolor{green}{k_{42}} & \\ 
        0 & 0 &  \textcolor{green}{k_{51}} &  \textcolor{green}{k_{52}} & \\ 
        0 & 0 &  \textcolor{green}{k_{61}} &  \textcolor{green}{k_{62}} & \\ 
        \end{bmatrix}
        \begin{Bmatrix}
            0 \\ 0 \\ 0 \\ 0
        \end{Bmatrix} &=
        \begin{Bmatrix}
            0 \\ \textcolor{purple}{f} \\ \frac{1}{2} \ell_{4-5} \textcolor{orange}{t} \\ 0 \\ \frac{1}{2} \ell_{4-5} \textcolor{orange}{t} \\ 0
        \end{Bmatrix} \\
        \begin{bmatrix}
            \textcolor{blue}{k_{13}} &  \textcolor{blue}{k_{14}} & 0 & 0 & 0 & 0 & \\ 
            \textcolor{blue}{k_{23}} &  \textcolor{blue}{k_{24}} & 0 & 0 & 0 & 0 & \\ 
            \textcolor{blue}{k_{53}} + \textcolor{red}{k_{31}} &  \textcolor{blue}{k_{54}} + \textcolor{red}{k_{32}} &  \textcolor{red}{k_{35}} + \textcolor{green}{k_{13}} &  \textcolor{red}{k_{36}} + \textcolor{green}{k_{14}} &  \textcolor{green}{k_{15}} &  \textcolor{green}{k_{16}} & \\ 
            \textcolor{blue}{k_{63}} + \textcolor{red}{k_{41}} &  \textcolor{blue}{k_{64}} + \textcolor{red}{k_{42}} &  \textcolor{red}{k_{45}} + \textcolor{green}{k_{23}} &  \textcolor{red}{k_{46}} + \textcolor{green}{k_{24}} &  \textcolor{green}{k_{25}} &  \textcolor{green}{k_{26}} & \\ 
        \end{bmatrix} 
        \begin{Bmatrix}
            u_2 \\ v_2 \\ u_4 \\ v_4 \\ u_5 \\ v_5
        \end{Bmatrix} + 
        \begin{bmatrix}
            \textcolor{blue}{k_{11}} &  \textcolor{blue}{k_{12}} &  \textcolor{blue}{k_{15}} &  \textcolor{blue}{k_{16}} & \\ 
            \textcolor{blue}{k_{21}} &  \textcolor{blue}{k_{22}} &  \textcolor{blue}{k_{25}} &  \textcolor{blue}{k_{26}} & \\ 
            \textcolor{blue}{k_{51}} &  \textcolor{blue}{k_{52}} &  \textcolor{blue}{k_{55}} + \textcolor{red}{k_{33}} + \textcolor{green}{k_{11}} &  \textcolor{blue}{k_{56}} + \textcolor{red}{k_{34}} + \textcolor{green}{k_{12}} & \\ 
            \textcolor{blue}{k_{61}} &  \textcolor{blue}{k_{62}} &  \textcolor{blue}{k_{65}} + \textcolor{red}{k_{43}} + \textcolor{green}{k_{21}} &  \textcolor{blue}{k_{66}} + \textcolor{red}{k_{44}} + \textcolor{green}{k_{22}} & \\ 
        \end{bmatrix}
        \begin{Bmatrix}
            0 \\ 0 \\ 0 \\ 0
        \end{Bmatrix}  &=
        \begin{Bmatrix}
            R_{x1} \\ R_{y1} \\ R_{x3} \\ R_{y3}
        \end{Bmatrix}
    \end{align*}
\end{landscape}

\section{Expressões para o Tetraedro Linear}

As mesmas relações gerais da seção anterior podem ser utilizadas para derivar as expressões para o elemento tetraédrico linear (figura \ref{fig:tetraedro}). A grande diferença é a passagem de uma modelagem bidimensional para uma tridimensional, o que implica em um aumento do número de graus de liberdade, e o abandono de EPT e EPD, como também a introdução de um nova condição de contorno sobre superfícies propriamente. De modo similar ao CST, o tetraedro é definido por três nós, nomeados $i$, $j$, $k$ e $m$, sobre os quais tanto o deslocamento é discretizado.

\begin{figure} 
    \centering
    \caption{Elemento tetraédrico}
    \begin{tikzpicture}
            \coordinate (i) at (1,0,3);
            \coordinate (j) at (4,0,6);
            \coordinate (k) at (8,0,3);
            \coordinate (m) at (6,9,7);
            
            \draw[blue, ultra thick, fill=blue, fill opacity = 0.2] 
                (j) 
                -- (m) -- (k)  
                -- cycle;
            \draw[blue, ultra thick, fill=blue, fill opacity = 0.2] 
            (i) -- (m) -- (j) -- cycle;
            \draw [->] (0,0,0) -- (8,0,0) node[anchor = west] {$x$};
            \draw [->] (0,0,0) -- (0,8,0) node[anchor = south] {$y$};
            \draw [->] (0,0,0) -- (0,0,8) node[anchor = east] {$z$};
            \draw[dashed, blue, ultra thick] (i) -- (k);
            \draw (i) node[blue, circle, draw, inner sep=1pt, fill=white, thin, scale = 1.1, fill opacity = 1] {$i$};
            \draw (j) node[blue, circle, draw, inner sep=1pt, fill=white, thin, scale = 1.1, fill opacity = 1] {$k$};
            \draw (k) node[blue, circle, draw, inner sep=1pt, fill=white, thin, scale = 1.1, fill opacity = 1] {$k$};
            \draw (m) node[blue, circle, draw, inner sep=1pt, fill=white, thin, scale = 1.1, fill opacity = 1] {$m$};
    \end{tikzpicture}
    \label{fig:tetraedro}
    \fonte{\me (2022)}
\end{figure}

\subsection{As funções de interpolação}


A primeira grande diferença é que agora a função de deslocamento $\bm{\varphi}^{(e)}$, tem três componentes, na forma

\begin{equation} \label{eq:funcao_deslocamento}
    \bm{\varphi}^{(e)} = \begin{Bmatrix}
        u(x,y,z) \\
        v(x,y,z) \\
        w(x,y,z)
    \end{Bmatrix}^{(e)} = \begin{Bmatrix}
        a_1 + a_2 x + a_3 y + a_4 z\\
        b_1 + b_2 x + b_3 y + b_4 z \\
        c_1 + c_2 x + c_3 y + c_4 z
    \end{Bmatrix}^({e}).
\end{equation}
em que $u$, $v$ e $w$ são as componentes do deslocamento nos eixos $x$, $y$ e $z$, respectivamente.

A proposta de interpolação desses valores continua sendo linear, isto é, a função de deslocamento é interpolada por um polinômio de primeiro grau, que é definido pelos valores do campo nos nós do elemento. No caso do tetraedro linear, há quatro nós, e portanto, quatro valores de deslocamento. Para descrever esses coeficientes em termos do deslocamento discretizado nos nó, basta seguir o mesmo procedimento da seção anterior, e montar um sistema de equações, na forma

\begin{equation}
    \begin{bmatrix}
        1 & x_1 & y_1 & z_1 \\
        1 & x_2 & y_2 & z_2 \\
        1 & x_3 & y_3 & z_3 \\
        1 & x_4 & y_4 & z_4 \\
    \end{bmatrix}
    \begin{Bmatrix}
        a_1 \\ a_2 \\ a_3 \\ a_4
    \end{Bmatrix} = 
    \begin{Bmatrix}
        u_1 \\ u_2 \\ u_3 \\ u_4
    \end{Bmatrix}.
\end{equation}

Logo, os coeficientes são expressos por

\begin{equation}
    \begin{Bmatrix}
        a_1 \\ a_2 \\ a_3 \\ a_4
    \end{Bmatrix} = 
    \begin{bmatrix}
        \alpha_1 & \alpha_2 & \alpha_3 & \alpha_4 \\
        \beta_1 & \beta_2 & \beta_3 & \beta_4 \\
        \gamma_1 & \gamma_2 & \gamma_3 & \gamma_4 \\
        \delta_1 & \delta_2 & \delta_3 & \delta_4 \\
    \end{bmatrix}
    \begin{Bmatrix}
        u_1 \\ u_2 \\ u_3 \\ u_4
    \end{Bmatrix}.
\end{equation}

Portanto,

\begin{equation}
    u(x,y,z) = 
    \begin{bmatrix}
        1 & x & y & z
    \end{bmatrix}
    \frac{1}{6V}
    \begin{bmatrix}
        \alpha_1 & \alpha_2 & \alpha_3 & \alpha_4 \\
        \beta_1 & \beta_2 & \beta_3 & \beta_4 \\
        \gamma_1 & \gamma_2 & \gamma_3 & \gamma_4 \\
        \delta_1 & \delta_2 & \delta_3 & \delta_4 \\
    \end{bmatrix}
    \begin{Bmatrix}
        u_1 \\ u_2 \\ u_3 \\ u_4
    \end{Bmatrix}.
\end{equation}
em que $V$ é o volume do tetraedro.

Expandindo os termos, temos que
\begin{equation}
    u(x,y,z) = \frac{1}{6V} (\alpha_1 + \beta_1 x + \gamma_1 y + \delta_1 z) u_1 + (\alpha_2 + \beta_2 x + \gamma_2 y + \delta_2 z) u_2 + (\alpha_3 + \beta_3 x + \gamma_3 y + \delta_3 z) u_3 + (\alpha_4 + \beta_4 x + \gamma_4 y + \delta_4 z) u_4.
\end{equation}

Desta forma, as funções de interpolação $N$ têm a forma

\begin{equation}
    N_i = \frac{1}{6V} (\alpha_1 + \beta_1 x + \gamma_1 y + \delta_1 z).
\end{equation}

Por fim, a forma discretizada da função de deslocamento $\bm{\varphi}^{(e)}$, em termos dos deslocamentos nodais, é

\begin{equation}
    \bm{\varphi}^{(e)} = \begin{Bmatrix}
        u(x,y,z) \\
        v(x,y,z) \\
        w(x,y,z)
    \end{Bmatrix}^{(e)} = 
    \begin{bmatrix}
        N_i & 0   & 0   & N_j & 0   & 0   & N_k & 0   & 0   & N_m & 0   & 0 \\
        0   & N_i & 0   & 0   & N_j & 0   & 0   & N_k & 0   & 0   & N_m & 0 \\
        0   & 0   & N_i & 0   & 0   & N_j & 0   & 0   & N_k & 0   & 0   & N_m \\
    \end{bmatrix}
    \begin{Bmatrix}
        u_i \\ v_i \\ w_i \\ u_j \\ v_j \\ w_j \\ u_k \\ v_k \\ w_k \\ u_m \\ v_m \\ w_m
    \end{Bmatrix}.
\end{equation}

\subsection{As Relações de Tensão-Deformação-Deslocamento}

Aplicando as definições do tensor de deformações na notação de Voigt, temos que

\begin{align}
    \epsilon_{xx} &= \frac{\partial u}{\partial x} = \frac{1}{6V}[\beta_i u_i + \beta_j u_j + \beta_k u_k + \beta_m u_m] \\
    \epsilon_{yy} &= \frac{\partial v}{\partial y} = \frac{1}{6V}[\gamma_i v_i + \gamma_j v_j + \gamma_k v_k + \gamma_m v_m] \\
    \epsilon_{zz} &= \frac{\partial w}{\partial z} = \frac{1}{6V}[\delta_i w_i + \delta_j w_j + \delta_k w_k + \delta_m w_m] \\
    \gamma_{xy} &= \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} = \frac{1}{6V}[\beta_i v_i + \beta_j v_j + \beta_k v_k + \beta_m v_m + \gamma_i u_i + \gamma_j u_j + \gamma_k u_k + \gamma_m u_m] \\
    \gamma_{xz} &= \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x} = \frac{1}{6V}[\delta_i u_i + \delta_j u_j + \delta_k u_k + \delta_m u_m + \beta_i w_i + \beta_j w_j + \beta_k w_k + \beta_m w_m] \\
    \gamma_{yz} &= \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y} = \frac{1}{6V}[\gamma_i w_i + \gamma_j w_j + \gamma_k w_k + \gamma_m w_m + \delta_i v_i + \delta_j v_j + \delta_k v_k + \delta_m v_m].
\end{align}

Portanto, a relação entre deformação e deslocamento é dada por

\begin{equation}
    \begin{Bmatrix}
        \epsilon_{xx} \\ \epsilon_{yy} \\ \epsilon_{zz} \\ \gamma_{xy} \\ \gamma_{xz} \\ \gamma_{yz}
    \end{Bmatrix} = \frac{1}{6V} 
    \begin{bmatrix}
\beta_i & 0 & 0 & \beta_j & 0 & 0 & \beta_k & 0 & 0 & \beta_m & 0 & 0 \\
0 & \gamma_i & 0 & 0 & \gamma_j & 0 & 0 & \gamma_k & 0 & 0 & \gamma_m & 0 \\
0 & 0 & \delta_i & 0 & 0 & \delta_j & 0 & 0 & \delta_k & 0 & 0 & \delta_m \\
\gamma_i & \beta_i & 0 & \gamma_j & \beta_j & 0 & \gamma_k & \beta_k & 0 & \gamma_m & \beta_m & 0 \\
\delta_i & 0 & \beta_i & \delta_j & 0 & \beta_j & \delta_k & 0 & \beta_k & \delta_m & 0 & \beta_m \\
0 & \delta_i & \gamma_i & 0 & \delta_j & \gamma_j & 0 & \delta_k & \gamma_k & 0 & \delta_m & \gamma_m
    \end{bmatrix} 
    \begin{Bmatrix}
        u_i \\ v_i \\ w_i \\ u_j \\ v_j \\ w_j \\ u_k \\ v_k \\ w_k \\ u_m \\ v_m \\ w_m
    \end{Bmatrix}.
\end{equation}

A relação entre tensão e deformação é dada pela lei de Hooke generalizada (equação \ref{eq:lei_de_hooke}). Logo,
\begin{equation}
    \{\sigma\} = \bm{C} \{\epsilon\} \implies \{\sigma\} = \bm{C} \bm{B} \bm{U}^{(e)}.
\end{equation}

\subsection{As condições de contorno}

Tal qual o CST, os carregamentos aplicados sobre as fronteiras dos elementos devem ser decompostos em forças nodais equivalentes. O mesmo procedimento descrito na seção anterior é aplicando o PTV. A integração da equação \ref{eq:forca_equivalente} então deve ser feita sobre o tetraedro o que, similar ao CST, tem uma forma algébrica, devido ao fato da simplicidade das funções de interpolação, como também é a mera distribuição uniforme do carregamento sobre os nós que compõe a superfície sobre a qual é aplicado. De acordo com \citeshort{Onate}, a força nodal equivalente sobre os nós de um carregamento uniforme na superfície de um elemento tetraédrico linear é dado por

\begin{equation}
    \bm{F}^{(e)}_{\bm{t}} = \frac{1}{3} A^{(e)} \bm{t},
\end{equation}
em que $A^{(e)}$ é a área da superfície do elemento em que atua o carregamento uniforme $\bm{t}$.
