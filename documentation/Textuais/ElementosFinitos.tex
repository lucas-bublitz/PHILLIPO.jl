\chapter{O Método dos Elementos Finitos}

\begin{quote}
    "As far as the laws of mathematics refer to reality, they are not certain; and as far as they are certain, they do not refer to reality." (Albert Einstein)
\end{quote}

O método dos elementos finitos (MEF) é um procedimento numérica utilizada para encontrar soluções de equações que modelam a natureza. É amplamente utilizado na simulação de fenômenos físicos, como mecânica dos sólidos, transferência de calor, eletromagnetismo e muitos outros. \cite{Onate}

A abordagem do MEF envolve a subdivisão de uma estrutura ou domínio contínuo em pequenos elementos geométricos finitos, definidos por nós, caracterizados por suas propriedades físicas e geométricas, em que são aplicadas as equações governantes do problema, cujo campo é aproximado, dentro de cada um, por meio de funções de interpolação, que vão discretizar o campo sobre os valores nodais. Em seguida, essas equações aproximadas são montadas, justapondo os elementos, em um sistema global, levando em consideração as condições de contorno e as restrições do problema. \cite{LIU}

Em suma, o método de elementos finitos segue o seguinte procedimento, de acordo com \citeshort{Onate}:

\begin{enumerate}
    \item definição do domínio, e das condições de contorno;
    \item discretização do domínio em uma malha formada por nós que constituem os elemento;
    \item aplicação das equações de governo sobre cada elemento, formando um sistema local de rigidez;
    \item assemblagem dessas equações em um único grande sistema global;
    \item resolução do sistema, encontrando os valores nodais do campo.
\end{enumerate}

Na análise estrutural aqui abordada, o objetivo da aplicação do MEF é determinar o deslocamento de um sólido em equilíbrio sujeito a carregamentos e restrições, dentro do regime elástico modelado pela Lei de Hooke, utilizando funções de interpolações lineares em elementos triangulares (na análise 2D: EPT ou EPD) e tetraédricos (na análise 3D). Para tanto, resolver um sistema da forma

\begin{equation}
    \bm{K} \bm{U} = \bm{F},
    \label{eq:sistema_global}
\end{equation}
em que $\bm{K}$ é a matriz de rigidez global, $\bm{U}$ é o vetor de deslocamentos nodais, e $\bm{F}$ é o vetor de forças nodais.

Deste modo, convém definir os termos e símbolos dessas entidades matemáticas. Seja um corpo $\mathcal{B}$, definido por uma geometria sobre o domínio $\Omega$, sobre o qual é feito uma série de repartições em pequenos elementos, de domínio $\Omega^{(e)}$, cuja fronteira se denomina $\partial\Omega^{(e)}$. A figura \ref{fig:dominio_triangulos} mostra um domínio bidimensional $\Omega$ discretizado em elementos triangulares, cujos nós são representados por $i, j$ e $k$, e a figura \ref{fig:tetraedro} mostra um domínio tridimensional $\Omega$ discretizado em elementos tetraédricos, cujos nós são representados por $i, j, k$ e $m$. Quando uma entidade é definida sobre um elemento, ela é representada por um superescrito $(e)$, como por exemplo, o deslocamento $\bm{\varphi}^{(e)}$ sobre o elemento $e$. Quando uma entidade é definida sobre um nó, ela é representada por um subescrito $(i)$, como por exemplo, o deslocamento $\bm{\varphi}_i$ sobre o nó $i$. Quando uma entidade é definida sobre um elemento e um nó, ela é representada por um superescrito e um subescrito, como por exemplo, o deslocamento $\bm{\varphi}_i^{(e)}$ sobre o nó $i$ do elemento $e$.

Neste capítulo é abordado como, na sequência proposta por \citeshort{LOGAN},

\begin{enumerate}
    \item selecionar as funções de interpolação;
    \item definir as relações de tensão-deformação-deslocamento;
    \item derivar a forma da matriz de rigidez;
    \item montar o sistema global e introduzir as condições de contorno.
\end{enumerate}

\input{Figuras/dominio_triangulos.tex}

\section{As Funções de Interpolação}

As funções de interpolação são funções matemáticas que aproximam o campo de interesse, neste caso o deslocamento, dentro de um elemento, por meio de uma combinação linear de funções conhecidas, definidas sobre os nós do elemento. Essas funções são definidas, e depois justapostas, de modo que o campo seja contínuo. O objetivo dessa ferramente é alterar os valores incógnitos do campo de contínuos para discretos, para que o deslocamento seja bem definido pelo seu valor sobre a posição cada nó, e que, por sobre o domínio de cada elemento, o campo seja interpolado. Esses valores discretos desconhecidos do campo nos nós, em que o campo tem "liberdade" pra variar, denominam-se \emph{graus de liberdade}. \cite{LOGAN}

O CST, por exemplo, tem seis graus de liberdade, uma vez que para cada nó, o vetor de deslocamento tem três componentes. Os problemas abordados aqui tem sempre três graus de liberdade por nó.

Defini-se, então, a função de deslocamento sobre um elemento, representado pela figura \ref{fig:dominio_triangulo}, assim como a proposta linear de interpolação,

\begin{equation}
    \bm{\varphi} = \begin{Bmatrix}
        u(x,y) \\ v(x,y) 
    \end{Bmatrix} = \begin{Bmatrix}
        a_1 + a_2 x + a_3 y \\ b_1 + b_2 x + b_3 y 
    \end{Bmatrix}.
\end{equation}
Nesse sentido, bidimensional, $\bm{\varphi}$ é uma função vetorial de campo que mapeia cada ponto do sólido para seu respectivo deslocamento nos eixos do sistema $xy$ ($u$ e $v$ respectivamente).

Para determinar as constantes $a$ e $b$, e termos dos deslocamentos nodais basta aplicar a condição de que em cada nó a função deve assumir o valor do deslocamento respectivo. Isto é, analisando somente a componente $x$, ou seja, $u(x,y)$, temos que

\begin{align}
    u(x_i, y_i) &= u_i &= a_1 + a_2 x_i + a_3 y_i, \\
    u(x_h, y_i) &= u_j &= a_1 + a_2 x_j + a_3 y_j, \\
    u(x_i, y_i) &= u_k &= a_1 + a_2 x_k + a_3 y_k,
\end{align}
em que $u_i$ é o valor do deslocamento nodais $i$, assim como $x_i$ e $y_i$ é sua posição sobre o domínio $\Omega$.
 
Reescrevendo esse sistema na forma matricial, temos que

\begin{equation}
    \begin{bmatrix}
        1 & x_i & y_i \\
        1 & x_j & y_j \\
        1 & x_k & y_k \\
    \end{bmatrix}
    \begin{bmatrix}
        a_1 \\ a_2 \\ a_3
    \end{bmatrix}
    = \begin{Bmatrix}
        u_i \\ u_j \\ u_k
    \end{Bmatrix} \implies
    \begin{Bmatrix}
        a_1 \\ a_2 \\ a_3
    \end{Bmatrix} =
    \frac{1}{2A}
    \begin{bmatrix}
        \alpha_i & \alpha_j & \alpha_k \\
        \beta_i & \beta_j & \beta_k \\
        \gamma_i & \gamma_j & \gamma_k \\
    \end{bmatrix}
    \begin{Bmatrix}
        u_i \\ u_j \\ u_k
    \end{Bmatrix},
    \label{eq:matriz_x}
\end{equation}

sendo que\footnote{É fácil demonstrar que esse sistema sempre é possível e determinado apenas observando o fato de que as posições dos nós são distintas e não colineares, a final os elementos são triangulares.}

\begin{equation}
    \frac{1}{2A}
    \begin{bmatrix}
        \alpha_i & \alpha_j & \alpha_k \\
        \beta_i & \beta_j & \beta_k \\
        \gamma_i & \gamma_j & \gamma_k \\
    \end{bmatrix} = 
    \begin{bmatrix}
        1 & x_i & y_i \\
        1 & x_j & y_j \\
        1 & x_k & y_k \\
    \end{bmatrix}^{-1} = \bm{X}^{-1},
\end{equation}
em que $A$ é área do elemento triangular. \footnote{Essa forma de escrever a inversa de $\bm{X}$ é interessante pois simplifica os termos $\alpha$, $\beta$ e $\gamma$ pelo determinante $2A$.}

Deste modo, a função de interpolação para $u(x,y)$ pode ser descrita em termos dos deslocamentos nodais na forma, utilizando o sistema \ref{eq:matriz_x},

\begin{equation}
    u(x,y) = \begin{bmatrix}
        1 & x & y
    \end{bmatrix} 
    \begin{Bmatrix}
        a_1 \\ a_2 \\ a_3
    \end{Bmatrix} = \begin{bmatrix}
        1 & x & y
    \end{bmatrix}  \frac{1}{2A}
    \begin{bmatrix}
        \alpha_i & \alpha_j & \alpha_k \\
        \beta_i & \beta_j & \beta_k \\
        \gamma_i & \gamma_j & \gamma_k \\
    \end{bmatrix}
    \begin{Bmatrix}
        u_i \\ u_j \\ u_k
    \end{Bmatrix}.
\end{equation}
Expandido essas expressões, multiplicando as matrizes e rearranjado os termos, temos que

\begin{equation}
    u(x,y) = \frac{1}{2A} \left[ \alpha_i + \beta_i x + \gamma_i y \right] u_i + \frac{1}{2A} \left[ \alpha_j + \beta_j x + \gamma_j y \right] u_j + \frac{1}{2A} \left[ \alpha_k + \beta_k x + \gamma_k y \right] u_k.
    \label{eq:funcao_u}
\end{equation}

É possível, também, definir a função de interpolação para a componente $v(x,y)$, de modo análogo, obtendo, apenas substituindo a função $u$ por $v$ nas equações anteriores, que as mesmas relações de interpolações são válidas também para a outra componente de $\bm{\varphi}$. Então, 

\begin{equation}
    v(x,y) = \frac{1}{2A} \left[ \alpha_i + \beta_i x + \gamma_i y \right] v_i + \frac{1}{2A} \left[ \alpha_j + \beta_j x + \gamma_j y \right] v_j + \frac{1}{2A} \left[ \alpha_k + \beta_k x + \gamma_k y \right] v_k.
    \label{eq:funcao_v}
\end{equation}

Para simplificar a notação das equações \ref{eq:funcao_u} e \ref{eq:funcao_v}, define-se funções $N$ da forma

\begin{align}
    N_i &= \frac{1}{2A} \left[ \alpha_i + \beta_i x + \gamma_i y \right], \\
    N_j &= \frac{1}{2A} \left[ \alpha_j + \beta_j x + \gamma_j y \right], \\
    N_k &= \frac{1}{2A} \left[ \alpha_k + \beta_k x + \gamma_k y \right].
\end{align}

Essas funções são denominadas \emph{Funções de forma} e representam a contribuição de cada grau de liberdade sobre o campo de deslocamento.

Por fim, $\bm{\varphi}$ pode ser reescrito na forma matricial, em termos dessas funções $N$ e dos deslocamentos nodais e $u$ e $v$, como

\begin{equation}
    \bm{\varphi} = \begin{Bmatrix}
        u(x,y) \\ v(x,y)
    \end{Bmatrix} = \begin{bmatrix}
        N_i & 0 & N_j & 0 & N_k & 0 \\
        0 & N_i & 0 & N_j & 0 & N_k
    \end{bmatrix} \begin{Bmatrix}
        u_i \\ v_i \\ u_j \\ v_j \\ u_k \\ v_k
    \end{Bmatrix} = \bm{N} \bm{U}^{(e)},
\end{equation}
em que $\bm{N}$ é a matrix de funções de interpolação, e $\bm{U}^{(e)}$ é o vetor de deslocamentos nodais do elemento.


\section{As Relações de Tensão-Deformação-Deslocamento}

No caso bidimensional, o vetor de deformação, na notação de Voigt, é dado por, conforme definido no capítulo anterior,

\begin{equation}
    \{\epsilon\} = \begin{Bmatrix}
        \epsilon_{xx} \\ \epsilon_{yy} \\ \gamma_{xy}
    \end{Bmatrix} =
    \begin{Bmatrix}
        \frac{\partial u}{\partial x} \\ \frac{\partial v}{\partial y} \\ \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}
    \end{Bmatrix}
\end{equation}

Aplicando nessas derivas parciais as funções de interpolação de $\bm{\varphi}$, das equações \ref{eq:funcao_u} e \ref{eq:funcao_v}, temos que, conforme \citeshort{LOGAN},

\begin{align}
    \frac{\partial u}{\partial x} &= \frac{1}{2A} \left[ \beta_i u_i + \beta_j u_j + \beta_k u_k\right],  \\
    \frac{\partial v}{\partial y} &= \frac{1}{2A} \left[ \gamma_i v_i + \gamma_j v_j + \gamma_k v_k\right],  \\
    \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x} &= \frac{1}{2A} \left[ \gamma_i u_i + \gamma_j u_j + \gamma_k u_k + \beta_i v_i + \beta_j v_j + \beta_k v_k \right].
\end{align}

Utilizando essas equações, é possível reescrever o vetor de deformação $\{\epsilon\}$ em termos dos coeficientes $\beta$ e $\gamma$, como também do vetor de deslocamentos nodais do elemento $\{U\}^{(e)}$, na forma

\begin{equation}
    \{\epsilon\} = \frac{1}{2A} \begin{bmatrix}
        \beta_i & 0 & \beta_j & 0 & \beta_k & 0 \\
        0 & \gamma_i & 0 & \gamma_j & 0 & \gamma_k \\
        \gamma_i & \beta_i & \gamma_j & \beta_j & \gamma_k & \beta_k
    \end{bmatrix} \begin{Bmatrix}
        u_i \\ v_i \\ u_j \\ v_j \\ u_k \\ v_k
    \end{Bmatrix} = \frac{1}{2A} \bm{B} \bm{U}^{(e)}.
    \label{eq:deformacao_deslocamento}
\end{equation}

A matrix $\bm{B}$ é denominada matrix gradiente, e é uma função das coordenadas dos nós do elemento, e relaciona o vetor de deslocamentos nodais do elemento $\bm{U}^{(e)}$ com o vetor de deformações $\{\epsilon\}$, assim como é constante ao longo de todo o elemento, o que é devido pela escolha de funções lineares para interpolar o campo de deslocamento sobre o elemento. Por causa dessa propriedade, esse elemento é denominado triângulo de deformações constantes, ou CST (\emph{Constant Strain Triangle}). \cite{LOGAN}

Por fim, ao passo que a relação entre deformação e tensão é dada pela Lei de Hooke generalizada, na forma da matriz constitutiva $\bm{C}$, expressar a relação entre tensão e deslocamento, ou tensão-Deformação-Deslocamento, é simplesmente uma questão de multiplicar a matriz constitutiva pela matriz gradiente, obtendo assim a relação

\begin{equation}
    \{\sigma\} = \bm{C} \bm{B} \bm{U}^{(e)}.
    \label{eq:relacao_tensao_deslocamento}
\end{equation}


\section{A Matriz de Rigidez Local}

A matriz de rigidez local é uma matriz quadrada, simétrica, que relaciona o vetor de forças nodais $\bm{F}^{(e)}$ com o vetor de deslocamentos nodais $\bm{U}^{(e)}$, na forma
\begin{equation}
    \bm{F}^{(e)} = \bm{K}^{(e)} \bm{U}^{(e)},
\end{equation}
cuja derivação é feita aplicando a equação de governo, o equilíbrio estático nesse caso, sobre o elemento, utilizando as funções de interpolação para o campo de deslocamentos. \cite{LOGAN}

$\bm{F}^{(e)}$ é um vetor que armazena as forças aplicadas sobre os nós do elemento, analogamente a $\bm{U}^{(e)}$ que armazena os deslocamentos nodais, e tem a forma

\begin{equation}
    \bm{F}^{(e)} = \begin{Bmatrix}
        fx_i \\ fy_j \\ fx_j \\ fy_j \\ fx_k \\ fy_k
    \end{Bmatrix}.
\end{equation}

Um dos métodos para derivar essa matriz é utilizar o \emph{Princípio dos Trabalhos Virtuais} de modo que a energia interna do elemento, devido à sua deformação elástica, seja igual ao trabalho virtual das forças externas. \cite{Zin}

Seja um elemento triangular, como da figura \ref{fig:dominio_triangulo}, que sofre um deslocamento virtual $\delta \bm{U}^{(e)}$. De acordo com \citeshort{Zin}, o trabalho interno do elemento é dado por\footnote{Poder escrever a energia interna desta forma simples é devido à escolha de que, na notação de Voigt do tensor de deformação, foi utilizado a convenção de $\gamma = 2 \epsilon$.}

\begin{equation}
    E_I = \int_{\Omega^{(e)}} \delta \{\epsilon\}^t \{\sigma\} dV,
\end{equation}

Utilizando as relações de tensão-deformação-deslocamento, descritas nas equações \ref{eq:deformacao_deslocamento} e \ref{eq:relacao_tensao_deslocamento}, temos que\footnote{Utilizando também a propriedade de transposição do produto de matrizes, $(\bm{A}\bm{B})^t = \bm{B}^t \bm{A}^t$.}

\begin{equation}
    E_I = \int_{\Omega^{(e)}} (\bm{B} \delta \bm{U}^{(e)})^t \bm{C} \bm{B} \bm{U}^{(e)} dV
    \implies E_I = \delta (\bm{U}^{(e)})^t \int_{\Omega^{(e)}} \bm{B}^t \bm{C} \bm{B} dV \bm{U}^{(e)}.
\end{equation}

O trabalho desenvolvido pelas forças externas é dado, também de acordo com \citeshort{Zin}, pelo produto dos deslocamento nodais e das forças nodais, na forma

\begin{equation}
    E_E = \delta (\bm{U}^{(e)})^t \bm{F}^{(e)}.
\end{equation}

Igualando as duas parcelas de trabalho, temos que

\begin{equation}
    E_I = E_E \implies
    \delta (\bm{U}^{(e)})^t \int_{\Omega^{(e)}} \bm{B}^t \bm{C} \bm{B} dV \bm{U}^{(e)} = \delta (\bm{U}^{(e)})^t \bm{F}^{(e)}.
\end{equation}

Portanto, 

\begin{equation}
    \bm{F}^{(e)} = \int_{\Omega^{(e)}} \bm{B}^t \bm{C} \bm{B} dV \bm{U}^{(e)}.
\end{equation}

Comparando com a forma da equação \ref{eq:sistema_global}, fica evidente que a matriz de rigidez local é dada por

\begin{equation}
    \bm{K}^{(e)} = \int_{\Omega^{(e)}} \bm{B}^t \bm{C} \bm{B} dV.
\end{equation}

O elemento tratado aqui é o CST, portanto, a matriz gradiente $\bm{B}$ é constante em todo o domínio $\Omega^{(e)}$, como também é constante a matriz constitutiva $\bm{C}$. A integral, portanto, não precisa ser computada em um sistema local, pois todos os termos que a compõe são constantes. \footnote{A definição de sistemas locais na formulação de outros tipos de elementos, em que a função de interpolação não é linear, como o quadrilátero, ou mesmo o triangular quadrático, é necessária, assim como definir transformações do sistema local para o global. Aqui, não sãos tradas transformações de coordenas pela simplicidade dos elementos.} Logo, a matriz de rigidez local pode ser simplificada ainda mais, tornando-se, de acordo com \citeshort{LOGAN}

\begin{equation}
    \bm{K}^{(e)} = \bm{B}^t \bm{C} \bm{B} \int_{\Omega^{(e)}} dV = \bm{B}^t \bm{C} \bm{B} V,
\end{equation}
em que $V$ é o volume do elemento, definido, no caso bidimensional, por $V = A d$, em que $d$ é a espessura.

Essa matriz pode ser lida como uma lista de causa e efeito. Enquanto a linha da matriz representa onde que o efeito do deslocamento é aplicado, a força no caso, a coluna informa qual é o deslocamento, o grau de liberdade, que o causa. \cite{LOGAN}

Outra forma de derivar essa relação diretamente da equação de equilíbrio estático é por meio do método de resíduos ponderados, em que as bases da função de deslocamento são as mesmas da função de ponderação. Esse método leva à mesma formulação mostrada acima.

Vale ressaltar que não foi preciso definir um sistema local de coordenadas para derivar essas relações, uma vez que o elemento tradado aqui, como também o tetraedro (tratado mais adiante), é simples o suficiente para que 

\section{Matriz de Rigidez Global e Condições de Contorno}

Para cada elemento do domínio é realizado o procedimento descrito na seção anterior, de encontrar a matriz de rigidez local que descreve o equilíbrio do elemento em termos das forças externas e do campo de deslocamento sobre os nós. Para resolver o problema, encontrar os deslocamentos de todos os nós, é necessário justapor essas matrizes locais em uma matriz global, ou seja,
\begin{equation}
    \bm{K} = \sum_{e} \bm{K}^{(e)}.
\end{equation}
Nesse contexto, $\Sigma$ representa, não uma soma ordinária, mas sim a sobreposição dos efeitos de rigidez sobre os os nós, num procedimento chamado \emph{Direct Stiffness Method}.  \cite{LOGAN}

Em cada elemento, a matriz local de rigidez $\bm{K}^{(e)}$ define a interação de forças e deslocamentos entre os nós do seu próprio elemento. Analisando a estrutura como um todo, cada nó pode pertencer a vários elementos, pois é assim que a malha é constituída. O efeito de rigidez, então, sobre cada nó é a soma dos efeitos de todos os elementos que o contém. Isso vale para os deslocamentos nodais, como para as forças nodais. O procedimento, portanto, de assemblagem da matriz global de rigidez é a soma das matrizes locais de rigidez sobre as posições sobre os graus de liberdade respectivos  matriz local.

[inserir mais texto aqui!!!]

A condições de contorno, tradas aqui, podem ser dividas em dois tipos: 

\begin{enumerate}
    \item de Dirichlet, ou de primeiro tipo, e
    \item de Neumann, ou de segundo tipo.
\end{enumerate}

 As condições de Dirichlet são aquelas que definem valores na fronteira do domínio do campo em si. Já as de Neumann, são aquelas que definem valores de contorno sobre a derivada nas fronteiras do domínio. \citeshort{diprima} Aqui, as condições de contorno de Dirichlet são restrições de deslocamento, enquanto as condições de Neumann são carregamentos aplicados sobre a estrutura.

As condições de contorno sobre os deslocamentos, então, dividem os graus de liberdade entre 

\begin{enumerate}
    \item livre;
    Quando não há informação prévia de seus valores, isto é, o campo pode variar livremente.
    \item prescritos;
    prescritos quando há informação prévia de seus valores, e portanto, não podem variar.
    \cite{LOGAN}
\end{enumerate}

Um engaste, por exemplo, é uma condição de contorno de Dirichlet que gera graus de liberdade prescritos, pois impõe que o deslocamento naquela região do sólido é nulo. Um deslocamento conhecido, também o faz, determinando que os graus correspondentes recebam o valor deslocado.

O vetor de forças $\bm{F}$ é nulo em regra sobre os graus de liberdade livres, pois essa entidade representa as forças externas sobre o elemento. Entretanto, quando se aplica condições de contorno de Neumann, os graus correspondentes devem receber forças nodais equivalentes, de forma que representem os carregamentos por forças externas concentradas nos nó.Pode-se encontrar as forças nodais equivalentes utilizando o mesmo método da seção anterior: o princípio dos trabalhos virtuais, fazendo com que o trabalho de carregamentos sobre a fronteira de um elemento $\partial \Omega^{(e)}$, causado por um deslocamento virtual $\delta \bm{U}^{(e)}$, seja igual ao trabalho da forças nodais equivalentes. Em termos matemáticos, de acordo com \citeshort{Zin},
\begin{equation}
    \delta (\bm{U}^{(e)})^t \bm{F}^{(e)} = \int_{\partial \Omega^{(e)}} (\bm{N}\bm{U}^{(e)})^t \bm{t} dl,
\end{equation}
em que $\bm{t}$ é o vetor do carregamento sobre a fronteira do elemento, na forma
\begin{equation}
    \bm{t} = \begin{Bmatrix}
        t_x(x,y) \\ t_y(x,y)
    \end{Bmatrix}.
\end{equation}

Aqui os carregamentos são constantes sobre as fronteiras dos elementos, isto é, são carregamentos distribuídos e uniformes. Deste modo, a equação anterior pode ser simplificada para

\begin{equation}
    \delta (\bm{U}^{(e)})^t \bm{F}^{(e)} = \delta \bm{U}^{(e)} \int_{\partial \Omega^{(e)}} \bm{N}^t dl \bm{t}. 
\end{equation}
Portanto, as forças nodais equivalentes, devidas a carregamentos uniformes sobre a fronteira do elemento, é dada por
\begin{equation}
    \bm{F}^{(e)} = \int_{\partial \Omega^{(e)}} \bm{N}^t dl \bm{t}.
\end{equation}

Essa integração é por vezes trabalhosa, e não pode ser feita algebricamente, tal qual a integração de definição da matriz de rigidez local. O elemento triangular de deformações constantes, entretanto, tem funções de interpolações cuja integração da matriz $\bm{N}$ seja possível de ser feita analiticamente. No elemento CST, o carregamento uniforme sobre a fronteira do elemento é aplicado igualmente sobre os nós que compõe aquela sessão da fronteira em forças nodais equivalentes, isto é, de acordo com \cite{Onate},

\begin{equation}
    \bm{F}^{(e)}_{\bm{t}} = \frac{1}{2} l^{(e)} d \bm{t}
\end{equation}
em que $\bm{F}^{(e)}_{\bm{t}}$ são as forças equivalentes que compreendem a fronteira em que o carregamento $\bm{t}$ é aplicado, $l^{(e)}$ é o comprimento da fronteira do elemento, e $d$ é a espessura do elemento.

\subsection{Solução direta do sistema global}

Com a determinação da matriz de rigidez global, as condições de contorno devidamente expressas em graus prescritos e livres (sejam deslocamento ou carregamentos), é possível reescrever o sistema geral da equação \ref{eq:sistema_global} na forma

\begin{equation}
    \begin{bmatrix}
        \bm{K}_{LL} & \bm{K}_{LP} \\
        \bm{K}_{PL} & \bm{K}_{PP}
    \end{bmatrix} 
    \begin{Bmatrix}
        \bm{U}_L \\ \bm{U}_P
    \end{Bmatrix}
    = \begin{Bmatrix}
        \bm{F}_L \\ \bm{F}_P
    \end{Bmatrix},
\end{equation}
em que os símbolos $\bm{K}$, $\bm{U}$ e $\bm{F}$, com índices $L$ e $P$ representam submatrizes correspondes aos graus de liberdade que estão livres ou prescritos. \cite{rao}

Nessa expressão, os graus de liberdade livres dos deslocamentos, em $\bm{U}$, são agrupados em um vetor único, denominado $\bm{U}_L$, o mesmo para os graus de liberdade livres das forças, agrupadas em $\bm{F}_L$. Os graus restantes, os prescritos, são então agrupados em $\bm{U}_P$ e $\bm{F}_P$, respectivamente. A matriz de rigidez global $\bm{K}$, por sua vez, pode ser decomposta em submatrizes correspondentes ao sistema divido em nesses grupos de graus de liberdade liver e restritos, como mostrado na equação acima.

Portanto, o sistema global pode ser reescrito mais uma vez em termos dessas submatrizes, como

\begin{align}
    \bm{K}_{LL} \bm{U}_L + \bm{K}_{LP} \bm{U}_P &= \bm{F}_L \\
    \bm{K}_{PL} \bm{U}_L + \bm{K}_{PP} \bm{U}_P &= \bm{F}_P.
\end{align}

Os valores conhecidos desse sistema são os deslocamentos sobre os graus prescritos, e as forças externas sobre o graus livres, a final, são as próprias condições de contorno definidas matematicamente pelo MEF. Logo, como o objetivo de resolver o sistema é encontrar os deslocamentos nodais, é possível isolar $\bm{U}_L$ na primeira equação, ou seja,

\begin{align}
    \bm{U}_L &= \bm{K}_{LL}^{-1} (\bm{F}_L - \bm{K}_{LP} \bm{U}_P), \\
    \bm{F}_P &= \bm{K}_{PL} \bm{U}_L + \bm{K}_{PP} \bm{U}_P.
\end{align}
a matriz $\bm{K}_{LL}$ é quadrada, simétrica e sempre possui inversa quando o problema está estaticamente determinado. \cite{rao}

As forças sobre os graus prescritos, $\bm{F}_P$, são denominadas reações, pois se referem às forças de reação do corpo sobre restrições de deslocamento (engastes, mancais etc.).


\section{Análise tridimensional sobre o tetraedro}

\subsection{Relação entre tensão, deformação e deslocamento}

Quando sólidos são postos sobre carregamentos, eles deforamam, criando tensões internas. A relaçaõ entre a tensão e a deformação

As componentes de tensão de sólidos em qualquer ponto são definidas sobre a superfície de um cubo infinitesimal, como mostrado na figura. Em cada superfície opera uma componente normal e duas tangenciais, denominadas, respectivamente, por tensão normal e de cisalhamento (o primeiro termo do índice subescrito indica a o plano de atuação da tensão, o segundo, a sua direção). O conjunto dessas tensões, de acordo com \citeshort{popov}, quando posto em forma matricial, é chamado de tensor de Couchy, em que as linhas indicam a superfície de atuação da tensão, e a coluna, a direção. Aplicando o somatório de momento no interior desse cubo, é fácil mostrar que, segundo \citeshort{LIU}:

\begin{equation}
    \sigma_{xy} = \sigma_{yx} \\
    \sigma_{xz} = \sigma_{zx} \\
    \sigma_{zy} = \sigma_{yz} \\
\end{equation}

Portanto, há somente um total de seis componentes distintas de tensão, permitindo que o tensor de Cauchy, possa ser reescrito de forma vetorial, mais compacta:

\begin{equation} \label{eq:vetor_tensao}
    \sigma^t =  \begin{bmatrix}
        \sigma_{xx} & \sigma_{yy} & \sigma_{zz} & \sigma_{yz} & \sigma_{xz} & \sigma_{xy}
    \end{bmatrix}
\end{equation}

A mesma estratégia pode, também, ser aplicada à matriz de deformação. Para cada componente do vector de tensão, em todo ponto do sólido, existe uma componenete do vector de deformação:

\begin{equation} \label{eq:vector_deformacao}
    \epsilon^t =  \begin{bmatrix}
        \epsilon_{xx} & \epsilon_{yy} & \epsilon_{zz} & \epsilon_{yz} & \epsilon_{xz} & \epsilon_{xy}
     \end{bmatrix}
\end{equation}

A deformação é a variação da função de deslocamento por unidade de comprimento, desse modo, os componentes do vetor de deformação podem definidos em função das derivadas da do desclocamento, da seguinte mandeira, de acordo com \citeshort{LIU}:

\begin{equation} \label{eq:defomacoes}
    \begin{matrix}
        \epsilon_{xx} = \frac{\partial u}{\partial x} &
        \epsilon_{yy} = \frac{\partial v}{\partial y} &
        \epsilon_{zz} = \frac{\partial w}{\partial z} \\
        \epsilon_{xy} = \frac{\partial u}{\partial y} + \frac{\partial u}{\partial y} &
        \epsilon_{xz} = \frac{\partial u}{\partial z} + \frac{\partial w}{\partial x} &
        \epsilon_{yz} = \frac{\partial v}{\partial z} + \frac{\partial w}{\partial y}
    \end{matrix}
\end{equation}

Nessas expressões, as funções $u$, $v$ e $w$ correspondem às componentes nas direções de $x$, $y$ e $z$, respectivamento, do vector de deslocamento sobre o sólido, que é definido como:

\begin{equation} \label{eq:funcao_deslocamento}
    \mathbf{\varphi} = \begin{Bmatrix}
        u(x,y,z) \\
        v(x,y,z) \\
        w(x,y,z)
    \end{Bmatrix}
\end{equation}


O cojunto de equaçãoes \ref{eq:defomacoes} pode ser reescrito em termos do vector de deformações e do vetor de deslocamentos do sólido, obtendo assim a relação deslocamento-deformação em forma matricial, como consta na expressão \ref{eq:relacao_deformacao_deslocamento}.

\begin{equation} \label{eq:relacao_deformacao_deslocamento}
    \epsilon = \mathbf{L} \mathbf{U}
\end{equation}

em que a matrix $\mathbf{L}$ é composta pelos operadores diferenciais parciais, da seguinte maneira:

\begin{equation}
    \mathbf{L} = \begin{bmatrix}
        \dfrac{\partial}{\partial x} & 0 & 0 \\
        0 & \dfrac{\partial}{\partial y} & 0 \\
        0 & 0 & \dfrac{\partial}{\partial z} \\
        0 & \dfrac{\partial}{\partial z} & \dfrac{\partial}{\partial y} \\
        \dfrac{\partial}{\partial z} & 0 & \dfrac{\partial}{\partial x} \\
        \dfrac{\partial}{\partial y} & \dfrac{\partial}{\partial x} & 0
    \end{bmatrix}
\end{equation}

A relação entre tensão e deformação, ou equações constitutivas, é comumente denomianda Lei de Hook, e é dada de acordo com \citeshort{LOGAN}, para um material isotrópico, em termos do módulo de Young ($E$) e o coeficiente de Poisson ($\nu$), ambos obtidos experimentalmente. De forma similar à relação dentre deformação e deslocamento, a relação tensão-deformação é expressa por:

\begin{equation}
    \sigma = \mathbf{D} \epsilon
\end{equation}

\begin{equation} \label{eq:matriz_constitutiva}
    \mathbf{D} = \frac{E}{(1+\nu)(1 - 2\nu)} \begin{bmatrix}
        1 - \nu & \nu & \nu & 0 & 0 & 0 \\
        \nu & 1 - \nu & \nu & 0 & 0 & 0 \\
        \nu & \nu & 1 - \nu & 0 & 0 & 0 \\
        0 & 0 & 0 & \frac{1 - 2\nu}{2} & 0 & 0 \\
        0 & 0 & 0 & 0 &\frac{1 - 2\nu}{2} & 0 \\
        0 & 0 & 0 & 0 & 0 &\frac{1 - 2\nu}{2} & \\
    \end{bmatrix}
\end{equation}

em que o termo $D$ é denominado matriz constitutiva, que é constante ao longo de todo o sólido.

\subsection{As funções de interpolação}

\begin{figure} 
    \centering
    \caption{Elemento tetraédrico}
    \begin{tikzpicture}
            \coordinate (i) at (1,0,3);
            \coordinate (j) at (4,0,6);
            \coordinate (k) at (8,0,3);
            \coordinate (m) at (6,9,7);
            
            \draw[blue, ultra thick, fill=blue, fill opacity = 0.2] 
                (j) 
                -- (m) -- (k)  
                -- cycle;
            \draw[blue, ultra thick, fill=blue, fill opacity = 0.2] 
            (i) -- (m) -- (j) -- cycle;
            \draw [->] (0,0,0) -- (8,0,0) node[anchor = west] {$x$};
            \draw [->] (0,0,0) -- (0,8,0) node[anchor = south] {$y$};
            \draw [->] (0,0,0) -- (0,0,8) node[anchor = east] {$z$};
            \draw[dashed, blue, ultra thick] (i) -- (k);
            \draw (i) node[blue, circle, draw, inner sep=1pt, fill=white, thin, scale = 1.1, fill opacity = 1] {$i$};
            \draw (j) node[blue, circle, draw, inner sep=1pt, fill=white, thin, scale = 1.1, fill opacity = 1] {$k$};
            \draw (k) node[blue, circle, draw, inner sep=1pt, fill=white, thin, scale = 1.1, fill opacity = 1] {$k$};
            \draw (m) node[blue, circle, draw, inner sep=1pt, fill=white, thin, scale = 1.1, fill opacity = 1] {$m$};
    \end{tikzpicture}
    \label{fig:tetraedro}
    \fonte{\me (2022)}
\end{figure}

Como já mencionado, a função de campo tratada aqui é o deslocamento sobre o sólido. Para cada elemento discretizado, essa função é interpolada por um polinômio, definido pelo valor do próprio campo nos nós do elemento. Em um elemento tetraédico, como o da figura \ref{fig:tetraedro}, há quatro nós ($i$, $j$, $k$ e $m$), e em cada um o campo de deslocamento tem três componentes. Essa liberdade do deslocamento que o campo tem nos nós é chamada de grau de liberdade. As funções de deslocamento, expressão \ref{eq:funcao_deslocamento}, como ditas anteriormes, são defnidas como lineares, o que garate a compatibilidade entre cada elemento, fazendo com que não existam desconitnuidades no campo de deslocamentos de acordo com \citeshort{LOGAN}. A função $\varphi$, portanto, pode ser decomposta em termos de suas variáveis da seguinte forma:

\begin{equation} \label{eq:linear}
    \mathbf{\varphi} = 
    \begin{Bmatrix}
        u(x,y,z) \\ v(x,y,z) \\ w(x,y,z)
    \end{Bmatrix} 
    = \begin{Bmatrix}
        a_1 + a_2 x + a_3 y + a_4 z\\
        b_1 + b_2 x + b_3 y + b_4 z\\
        c_1 + c_2 x + c_3 y + c_4 z\\
    \end{Bmatrix}
\end{equation}

Para encotrar esses fatores, basta aplicar as funções em cada nó.

\begin{equation}
    \begin{cases}
        u_i = a_1 + a_2 x_i + a_3 y_i + a_4 z_i \\
        u_j = a_1 + a_2 x_j + a_3 y_j + a_4 z_j \\
        u_k = a_1 + a_2 x_k + a_3 y_k + a_4 z_k \\
        u_m = a_1 + a_2 x_m + a_3 y_m + a_4 z_i
    \end{cases}
\end{equation}

Esse sistema pode ser rearranjado na seguinte forma matricial:

\begin{equation}
    \{\mathbf{u}\} = \begin{Bmatrix}
        u_i \\
        u_j \\
        u_k \\
        u_m
    \end{Bmatrix} = 
    \begin{bmatrix}
        1 & x_i & y_i & z_i \\
        1 & x_j & y_j & z_j \\
        1 & x_k & y_k & z_k \\
        1 & x_m & y_m & z_m \\
    \end{bmatrix}
    \begin{bmatrix}
        a_1 \\ a_2 \\ a_3 \\ a_4
    \end{bmatrix} 
\end{equation}

Portanto,

\begin{equation}
    \begin{bmatrix}
        a_1 \\ a_2 \\ a_3 \\ a_4
    \end{bmatrix}
    = \begin{bmatrix}
        1 & x_i & y_i & z_i \\
        1 & x_j & y_j & z_j \\
        1 & x_k & y_k & z_k \\
        1 & x_m & y_m & z_m \\
    \end{bmatrix}^{-1} \{\mathbf{u}\}
\end{equation}

O mesmo procedimento pode ser aplicado às outras funções de deslocamento ($v$ e $w$).




